'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
  return typeof obj;
} : function (obj) {
  return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
};

/*+***********************************************************************************
 * The contents of this file are subject to the vtiger CRM Public License Version 1.0
 * ("License"); You may not use this file except in compliance with the License
 * The Original Code is:  vtiger CRM Open Source
 * The Initial Developer of the Original Code is vtiger.
 * Portions created by vtiger are Copyright (C) vtiger.
 * All Rights Reserved.
 *************************************************************************************/AppConnector={/**
	 * Sends a pjax request (push state +ajax)
	 * The function is deferred. it will be resolved on success and error on failure
	 *  Success - if request is success it will send you data that it recieved
	 *  error - it will send two parameters first gives string regarding error
	 *                   Second gives you error object if exists
	 *
	 *  @return - deferred promise
	 */requestPjax:function requestPjax(params){return AppConnector._request(params,!0)},/**
	 *  Sends ajax request to the specified url.
	 *  The function is deferred. it will be resolved on success and error on failure
	 *  Success - if request is success it will send you data that it recieved
	 *  error - it will send two parameters first gives string regarding error
	 *                   Second gives you error object if exists
	 *
	 *  @return - deferred promise
	 */request:function request(params,rawData){return AppConnector._request(params,!1,rawData)},_request:function _request(params,pjaxMode,rawData){var aDeferred=jQuery.Deferred();'undefined'==typeof rawData&&(rawData=!1),'undefined'==typeof pjaxMode&&(pjaxMode=!1),'undefined'==typeof params&&(params={});var fullUrl='';//caller has send only data
if('undefined'==typeof params.data||rawData){if('string'==typeof params){var callerParams=fullUrl=params,index=callerParams.indexOf('?');if(-1!==index){var subStr=callerParams.substr(0,index+1);//need to replace only "index.php?" or "?"
callerParams=callerParams.replace(subStr,'');}params={type:'GET'};}else callerParams=jQuery.extend({},params),params={};params.data=callerParams;}//Make the request as post by default
//By default we expect json from the server
if(('undefined'==typeof params.type||rawData)&&(params.type='POST'),('undefined'==typeof params.jsonp||rawData)&&(params.jsonp=!1),'undefined'==typeof params.dataType||rawData){var data=params.data;//view will return html
params.dataType='json',data.hasOwnProperty('view')?params.dataType='html':'string'==typeof data&&-1!==data.indexOf('&view=')&&(params.dataType='html'),'undefined'!=typeof params.url&&-1!==params.url.indexOf('&view=')&&(params.dataType='html');}//If url contains params then seperate them and make them as data
if('undefined'!=typeof params.url&&-1!==params.url.indexOf('?')){fullUrl=params.url;var urlSplit=params.url.split('?'),queryString=urlSplit[1];params.url=urlSplit[0];for(var queryParameters=queryString.split('&'),index=0;index<queryParameters.length;index++){var queryParam=queryParameters[index],queryParamComponents=queryParam.split('=');params.data[queryParamComponents[0]]=queryParamComponents[1];}}if(('undefined'==typeof params.url||0>=params.url.length)&&(params.url='index.php'),params.success=function(data){null!==data&&'object'===('undefined'==typeof data?'undefined':_typeof(data))&&data.error&&(app.errorLog(data.error),data.error.message&&Vtiger_Helper_Js.showMessage({text:data.error.message,type:'error'})),console.log(data),aDeferred.resolve(data);},params.error=function(jqXHR,textStatus,errorThrown){console.warn('%cYetiForce debug mode!!!','color: red; font-family: sans-serif; font-size: 1.5em; font-weight: bolder; text-shadow: #000 1px 1px;'),console.error('Error: '+errorThrown,'\n------------------------------------------------------------------------------------------------------------------------------------------------------\nTrace:\n------------------------------------------------------------------------------------------------------------------------------------------------------\n------------------------------------------------------------------------------------------------------------------------------------------------------\nParams:\n------------------------------------------------------------------------------------------------------------------------------------------------------\n'+JSON.stringify(params,null,'\t')),aDeferred.reject(textStatus,errorThrown);},jQuery.ajax(params),pjaxMode&&(''===fullUrl?fullUrl='index.php?'+$.param(params.data):-1===fullUrl.indexOf('index.php?')&&(fullUrl='index.php?'+fullUrl),history.pushState&&''!==fullUrl)){var currentHref=window.location.href;history.state||history.replaceState(currentHref,'title 1',currentHref),history.pushState(fullUrl,'title 2',fullUrl);}return aDeferred.promise()},requestForm:function requestForm(url,params){var newEle='<form action='+url+' method="POST">';'undefined'!=typeof csrfMagicName&&(newEle+='<input type="hidden" name="'+csrfMagicName+'"  value=\''+csrfMagicToken+'\'>'),'undefined'!=typeof params&&jQuery.each(params,function(index,value){newEle+='<input type="hidden" name="'+index+'"  value=\''+value+'\'>';}),newEle+='</form>';var form=new jQuery(newEle);form.appendTo('body').submit();}};
//# sourceMappingURL=Connector.min.js.map
