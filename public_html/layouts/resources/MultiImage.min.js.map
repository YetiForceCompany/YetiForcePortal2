{"version":3,"file":"MultiImage.min.js","sources":["MultiImage.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\n\nclass MultiImage {\n\t/**\n\t * Create class instance\n\t *\n\t * @param {HTMLElement|jQuery} inputElement - input type file element inside component\n\t */\n\tconstructor(element) {\n\t\tconst thisInstance = this;\n\t\tthis.elements = {};\n\t\tthis.options = {\n\t\t\tshowCarousel: true\n\t\t};\n\t\tthis.detailView = false;\n\t\tthis.elements.fileInput = element.find('.js-multi-image__file').eq(0);\n\t\tif (this.elements.fileInput.length === 0) {\n\t\t\tthis.detailView = true;\n\t\t}\n\t\tthis.elements.component = element.eq(0);\n\t\tthis.elements.form = element.closest('form').eq(0);\n\t\tthis.elements.addButton = this.elements.component.find('.js-multi-image__file-btn').eq(0);\n\t\tthis.elements.values = this.elements.component.find('.js-multi-image__values').eq(0);\n\t\tthis.elements.progressBar = this.elements.component.find('.js-multi-image__progress-bar').eq(0);\n\t\tthis.elements.progress = this.elements.component.find('.js-multi-image__progress').eq(0);\n\t\tthis.elements.result = this.elements.component.find('.js-multi-image__result').eq(0);\n\t\tthis.fieldInfo = this.elements.values.data('fieldinfo');\n\t\tthis.options.formats = this.fieldInfo.formats;\n\t\tthis.options.limit = this.fieldInfo.limit;\n\t\tif (!this.detailView) {\n\t\t\tthis.files = JSON.parse(this.elements.values.val());\n\t\t} else {\n\t\t\tthis.files = this.elements.values.data('value');\n\t\t}\n\t\tif (!this.detailView) {\n\t\t\tthis.elements.fileInput.fileupload({\n\t\t\t\tdataType: 'json',\n\t\t\t\treplaceFileInput: false,\n\t\t\t\tfileInput: this.fileInput,\n\t\t\t\tautoUpload: false,\n\t\t\t\tadd: this.add.bind(this),\n\t\t\t\tchange: this.change.bind(this),\n\t\t\t\tfail: this.uploadError.bind(this)\n\t\t\t});\n\t\t}\n\t\tthis.elements.component.on('click', '.js-multi-image__popover-img', function (e) {\n\t\t\tthisInstance.zoomPreview($(this).data('hash'));\n\t\t});\n\t\tthis.elements.component.on('click', '.js-multi-image__popover-btn-zoom', function (e) {\n\t\t\te.preventDefault();\n\t\t\tthisInstance.zoomPreview($(this).data('hash'));\n\t\t});\n\t\tthis.elements.component.on('click', '.js-multi-image__popover-btn-download', function (e) {\n\t\t\te.preventDefault();\n\t\t\tthisInstance.download($(this).data('hash'));\n\t\t});\n\t\tif (!this.detailView) {\n\t\t\tthis.elements.component.on('click', '.js-multi-image__popover-btn-delete', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthisInstance.deleteFile($(this).data('hash'));\n\t\t\t});\n\t\t}\n\t\tthis.loadExistingFiles();\n\t}\n\n\t/**\n\t * Prevent form submission\n\t *\n\t * @param {Event} e\n\t */\n\taddButtonClick(e) {\n\t\te.preventDefault();\n\t\tthis.elements.fileInput.trigger('click');\n\t}\n\n\t/**\n\t * Get file information\n\t *\n\t * @param {String} hash - file id\n\t * @returns {Object}\n\t */\n\tgetFileInfo(hash) {\n\t\tfor (let i = 0, len = this.files.length; i < len; i++) {\n\t\t\tconst file = this.files[i];\n\t\t\tif (file.hash === hash) {\n\t\t\t\treturn file;\n\t\t\t}\n\t\t}\n\t\tapp.errorLog(`File '${hash}' not found.`);\n\t\tapp.showNotify({\n\t\t\ttext: app.translate('JS_INVALID_FILE_HASH') + ` [${hash}]`,\n\t\t\ttype: 'error'\n\t\t});\n\t}\n\n\t/**\n\t * Add property to file info object\n\t *\n\t * @param {String} hash - file id\n\t * @param {String} propertyName\n\t * @param {any} value\n\t * @returns {Object}\n\t */\n\taddFileInfoProperty(hash, propertyName, value) {\n\t\tconst fileInfo = this.getFileInfo(hash);\n\t\tfileInfo[propertyName] = value;\n\t\treturn fileInfo;\n\t}\n\n\t/**\n\t * Error event handler from file upload request\n\t *\n\t * @param {Event} e\n\t * @param {Object} data\n\t */\n\tuploadError(e, data) {\n\t\tapp.errorLog('File upload error.');\n\t\tconst { jqXHR, files } = data;\n\t\tif (typeof jqXHR.responseJSON === 'undefined' || jqXHR.responseJSON === null) {\n\t\t\tApp.Fields.MultiImage.currentFileUploads--;\n\t\t\treturn app.showNotify({\n\t\t\t\ttext: app.translate('JS_FILE_UPLOAD_ERROR'),\n\t\t\t\ttype: 'error'\n\t\t\t});\n\t\t}\n\t\tconst response = jqXHR.responseJSON;\n\t\t// first try to show error for concrete file\n\t\tif (\n\t\t\ttypeof response.result !== 'undefined' &&\n\t\t\ttypeof response.result.attach !== 'undefined' &&\n\t\t\tArray.isArray(response.result.attach)\n\t\t) {\n\t\t\tresponse.result.attach.forEach((fileAttach) => {\n\t\t\t\tApp.Fields.MultiImage.currentFileUploads--;\n\t\t\t\tthis.deleteFile(fileAttach.hash, false);\n\t\t\t\tif (typeof fileAttach.error === 'string') {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: fileAttach.error + ` [${fileAttach.name}]`,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: app.translate('JS_FILE_UPLOAD_ERROR') + ` [${fileAttach.name}]`,\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.updateFormValues();\n\t\t\treturn;\n\t\t}\n\t\t// else show default upload error\n\t\tfiles.forEach((file) => {\n\t\t\tApp.Fields.MultiImage.currentFileUploads--;\n\t\t\tthis.deleteFile(file.hash, false);\n\t\t\tapp.showNotify({\n\t\t\t\ttext: app.translate('JS_FILE_UPLOAD_ERROR') + ` [${file.name}]`,\n\t\t\t\ttype: 'error'\n\t\t\t});\n\t\t});\n\t\tthis.updateFormValues();\n\t}\n\n\t/**\n\t * Update form input values\n\t */\n\tupdateFormValues() {\n\t\tconst formValues = this.files.map((file) => {\n\t\t\treturn { key: file.key, name: file.name, size: file.size };\n\t\t});\n\t\tthis.elements.values.val(JSON.stringify(formValues));\n\t}\n\n\t/**\n\t * Validate file\n\t *\n\t * @param {Object} file\n\t * @returns {boolean}\n\t */\n\tvalidateFile(file) {\n\t\tlet valid = false;\n\t\tthis.options.formats.forEach((format) => {\n\t\t\tif (file.type === 'image/' + format) {\n\t\t\t\tvalid = true;\n\t\t\t}\n\t\t});\n\t\tif (!valid) {\n\t\t\tapp.showNotify({\n\t\t\t\ttext: `${app.translate('JS_INVALID_FILE_TYPE')} [${file.name}]\\n${app.translate(\n\t\t\t\t\t'JS_AVAILABLE_FILE_TYPES'\n\t\t\t\t)}  [${this.options.formats.join(', ')}]`,\n\t\t\t\ttype: 'error'\n\t\t\t});\n\t\t}\n\t\treturn valid;\n\t}\n\n\t/**\n\t * Show limit error\n\t */\n\tshowLimitError() {\n\t\tthis.elements.fileInput.val('');\n\t\tapp.showNotify({\n\t\t\ttext: `${app.translate('JS_FILE_LIMIT')} [${this.options.limit}]`,\n\t\t\ttype: 'error'\n\t\t});\n\t}\n\n\t/**\n\t * Get only valid files from list\n\t *\n\t * @param {Array} files\n\t * @returns {Array}\n\t */\n\tfilterValidFiles(files) {\n\t\tif (files.length + this.files.length > this.options.limit) {\n\t\t\tthis.showLimitError();\n\t\t\treturn [];\n\t\t}\n\t\treturn files.filter((file) => {\n\t\t\treturn this.validateFile(file);\n\t\t});\n\t}\n\n\t/**\n\t * Set files hash\n\t * @param {Array} files\n\t * @returns {Array}\n\t */\n\tsetFilesHash(files) {\n\t\tconst addedFiles = [];\n\t\tfor (let i = 0, len = files.length; i < len; i++) {\n\t\t\tconst file = files[i];\n\t\t\tif (typeof file.hash === 'undefined') {\n\t\t\t\tif (this.files.length < this.options.limit) {\n\t\t\t\t\tfile.hash = this.generateRandomHash(CONFIG.userId);\n\t\t\t\t\tthis.files.push({ hash: file.hash, imageSrc: file.imageSrc, name: file.name, file });\n\t\t\t\t\taddedFiles.push(file);\n\t\t\t\t} else {\n\t\t\t\t\tthis.showLimitError();\n\t\t\t\t\treturn addedFiles;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn addedFiles;\n\t}\n\n\t/**\n\t * Add event handler from jQuery-file-upload\n\t *\n\t * @param {Event} e\n\t * @param {object} data\n\t */\n\tadd(e, data) {\n\t\treturn;\n\t}\n\n\t/**\n\t * Progressall event handler from jQuery-file-upload\n\t *\n\t * @param {Event} e\n\t * @param {Object} data\n\t */\n\tprogressAll(e, data) {\n\t\tconst progress = parseInt((data.loaded / data.total) * 100, 10);\n\t\tthis.elements.progressBar.css({ width: progress + '%' });\n\t\tif (progress === 100) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.elements.progress.addClass('d-none');\n\t\t\t\tthis.elements.progressBar.css({ width: '0%' });\n\t\t\t}, 1000);\n\t\t} else {\n\t\t\tthis.elements.progress.removeClass('d-none');\n\t\t}\n\t}\n\n\t/**\n\t * Dragover event handler from jQuery-file-upload\n\t *\n\t * @param {Event} e\n\t */\n\tdragOver(e) {\n\t\tthis.elements.component.addClass('c-multi-image__drop-effect');\n\t}\n\n\t/**\n\t * Dragleave event handler\n\t * @param {Event} e\n\t */\n\tdragLeave(e) {\n\t\tthis.elements.component.removeClass('c-multi-image__drop-effect');\n\t}\n\n\t/**\n\t * Download file according to source type (base64/file from server)\n\t *\n\t * @param {String} hash\n\t */\n\tdownload(hash) {\n\t\tconst fileInfo = this.getFileInfo(hash);\n\t\tif (fileInfo.imageSrc.substr(0, 8).toLowerCase() === 'file.php') {\n\t\t\treturn this.downloadFile(hash);\n\t\t} else {\n\t\t\treturn this.downloadBase64(hash);\n\t\t}\n\t}\n\n\t/**\n\t * Download file that exists on the server already\n\t * @param {String} hash\n\t */\n\tdownloadFile(hash) {\n\t\tconst fileInfo = this.getFileInfo(hash);\n\t\tconst link = document.createElement('a');\n\t\t$(link).css('display', 'none');\n\t\tif (typeof link.download === 'string') {\n\t\t\tdocument.body.appendChild(link); // Firefox requires the link to be in the body\n\t\t\tlink.download = fileInfo.name;\n\t\t\tlink.href = fileInfo.imageSrc;\n\t\t\tlink.click();\n\t\t\tdocument.body.removeChild(link); // remove the link when done\n\t\t} else {\n\t\t\tlocation.replace(fileInfo.imageSrc);\n\t\t}\n\t}\n\n\t/**\n\t * Download file from base64 image\n\t *\n\t * @param {String} hash\n\t */\n\tdownloadBase64(hash) {\n\t\tconst fileInfo = this.getFileInfo(hash);\n\t\tconst imageUrl =\n\t\t\t`data:application/octet-stream;filename=${fileInfo.name};base64,` + fileInfo.imageSrc.split(',')[1];\n\t\tconst link = document.createElement('a');\n\t\t$(link).css('display', 'none');\n\t\tif (typeof link.download === 'string') {\n\t\t\tdocument.body.appendChild(link); // Firefox requires the link to be in the body\n\t\t\tlink.download = fileInfo.name;\n\t\t\tlink.href = imageUrl;\n\t\t\tlink.click();\n\t\t\tdocument.body.removeChild(link); // remove the link when done\n\t\t} else {\n\t\t\tlocation.replace(imageUrl);\n\t\t}\n\t}\n\n\t/**\n\t * Display modal window with large preview\n\t *\n\t * @param {string} hash\n\t */\n\tzoomPreview(hash) {\n\t\tconst self = this;\n\t\tlet fileInfo = this.getFileInfo(hash);\n\t\tconst titleTemplate = () => {\n\t\t\tconst titleObject = document.createElement('span');\n\t\t\tconst icon = document.createElement('i');\n\t\t\ticon.setAttribute('class', `fa fa-image`);\n\t\t\ttitleObject.appendChild(icon);\n\t\t\ttitleObject.appendChild(document.createTextNode(` ${fileInfo.name}`));\n\t\t\treturn titleObject.innerHTML;\n\t\t};\n\n\t\tlet buttons = [];\n\t\tif (!self.detailView) {\n\t\t\tbuttons.push({\n\t\t\t\ttext: app.translate('JS_DELETE'),\n\t\t\t\ticon: 'fa fa-trash-alt',\n\t\t\t\tclass: 'float-left btn btn-danger js-delete'\n\t\t\t});\n\t\t}\n\t\tbuttons.push(\n\t\t\t{\n\t\t\t\ttext: app.translate('JS_DOWNLOAD'),\n\t\t\t\ticon: 'fa fa-download',\n\t\t\t\tclass: 'float-left btn btn-success js-success'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: app.translate('JS_CLOSE'),\n\t\t\t\ticon: 'fa fa-times',\n\t\t\t\tclass: 'btn btn-warning',\n\t\t\t\tdata: { dismiss: 'modal' }\n\t\t\t}\n\t\t);\n\t\tapp.showModalHtml({\n\t\t\tclass: 'modal-lg',\n\t\t\theader: titleTemplate(),\n\t\t\tfooterButtons: buttons,\n\t\t\tbody: self.options.showCarousel\n\t\t\t\t? self.generateCarousel(hash)\n\t\t\t\t: `<img src=\"${fileInfo.imageSrc}\" class=\"w-100\" />`,\n\t\t\tcb: (modal) => {\n\t\t\t\tmodal.on('click', '.js-delete', function () {\n\t\t\t\t\tself.deleteFile(fileInfo.hash);\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t});\n\t\t\t\tmodal.on('click', '.js-success', function () {\n\t\t\t\t\tself.download(fileInfo.hash);\n\t\t\t\t\tapp.hideModalWindow();\n\t\t\t\t});\n\t\t\t\tif (self.options.showCarousel) {\n\t\t\t\t\tmodal.find(`#carousel-${hash}`).on('slid.bs.carousel', (e) => {\n\t\t\t\t\t\tfileInfo = self.getFileInfo($(e.relatedTarget).data('hash'));\n\t\t\t\t\t\tmodal.find('.js-modal-title').html(titleTemplate());\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Remove file from preview and from file list\n\t *\n\t * @param {String} hash\n\t */\n\tdeleteFileCallback(hash) {\n\t\tconst fileInfo = this.getFileInfo(hash);\n\t\tif (fileInfo.previewElement) {\n\t\t\tfileInfo.previewElement.popover('dispose').remove();\n\t\t}\n\t\tthis.files = this.files.filter((file) => file.hash !== fileInfo.hash);\n\t\tthis.updateFormValues();\n\t}\n\n\t/**\n\t * Delete image from input field\n\t * Should be called with this pointing on button element with data-hash attribute\n\t *\n\t * @param {string} hash\n\t * @param {boolean} showConfirmation - dialog?\n\t */\n\tdeleteFile(hash, showConfirmation = true) {\n\t\tif (showConfirmation) {\n\t\t\tconst fileInfo = this.getFileInfo(hash);\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: fileInfo.name,\n\t\t\t\ttext: app.translate('JS_DELETE_FILE_CONFIRMATION'),\n\t\t\t\ttitleTrusted: false,\n\t\t\t\ticon: 'fa fa-trash-alt',\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tthis.deleteFileCallback(hash);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tthis.deleteFileCallback(hash);\n\t\t}\n\t}\n\n\t/**\n\t * File change event handler from jQuery-file-upload\n\t *\n\t * @param {Event} e\n\t * @param {object} data\n\t */\n\tchange(e, data) {\n\t\tthis.clearFilesInput();\n\t\tdata.files = this.filterValidFiles(data.files);\n\t\tdata.files = this.setFilesHash(data.files);\n\t\tif (data.files.length) {\n\t\t\tthis.generatePreviewElements(data.files, (element) => {\n\t\t\t\tthis.redraw();\n\t\t\t});\n\t\t}\n\t}\n\n\tclearFilesInput() {\n\t\tthis.files.forEach((file) => {\n\t\t\tif (file.file) {\n\t\t\t\tthis.deleteFile(file.hash, false);\n\t\t\t}\n\t\t});\n\t}\n\t/**\n\t * Generate and apply popover to preview\n\t *\n\t * @param {File} file\n\t * @param {string} template\n\t * @param {string} imageSrc\n\t * @returns {jQuery}\n\t */\n\taddPreviewPopover(file, template, imageSrc) {\n\t\tconst thisInstance = this;\n\t\tlet fileSize = '';\n\t\tconst fileInfo = this.getFileInfo(file.hash);\n\t\tif (typeof fileInfo.size !== 'undefined') {\n\t\t\tfileSize = `<div class=\"p-1 ml-1 bg-white border rounded small position-absolute\">${fileInfo.size}</div>`;\n\t\t}\n\t\tlet deleteBtn = '';\n\t\tif (!this.detailView) {\n\t\t\tdeleteBtn = `<button class=\"btn btn-sm btn-danger c-btn-collapsible js-multi-image__popover-btn-delete mb-1\" type=\"button\" data-hash=\"${\n\t\t\t\tfile.hash\n\t\t\t}\" data-js=\"click\" title=\"${app.translate('JS_DELETE')}\"><i class=\"fa fa-trash-alt\"></i></button>`;\n\t\t}\n\t\treturn $(template).popover({\n\t\t\tcontainer: thisInstance.elements.component,\n\t\t\ttitle: `<div class=\"u-text-ellipsis\"><i class=\"fa fa-image\"></i> ${file.name}</div>`,\n\t\t\thtml: true,\n\t\t\tsanitize: false,\n\t\t\ttrigger: 'focus',\n\t\t\tplacement: 'top',\n\t\t\tcontent: `<img src=\"${imageSrc}\" class=\"w-100 js-multi-image__popover-img c-multi-image__popover-img\" data-hash=\"${file.hash}\" data-js=\"click\"/>`,\n\t\t\ttemplate: `<div class=\"popover\" role=\"tooltip\">\n\t\t\t\t<div class=\"arrow\"></div>\n\t\t\t\t<h3 class=\"popover-header\"></h3>\n\t\t\t\t<div class=\"popover-body\"></div>\n\t\t\t\t<div class=\"text-right popover-footer js-multi-image__popover-actions\">\n\t\t\t\t\t${fileSize}\n\t\t\t\t\t${deleteBtn}\n\t\t\t\t\t<button class=\"btn btn-sm btn-success js-multi-image__popover-btn-download mb-1\" type=\"button\" data-hash=\"${\n\t\t\t\t\t\tfile.hash\n\t\t\t\t\t}\" data-js=\"click\"><i class=\"fa fa-download\" title=\"${app.translate(\n\t\t\t\t'JS_DOWNLOAD'\n\t\t\t)}\"></i> <span class=\"c-btn-collapsible__text\"></span></button>\n\t\t\t\t\t<button class=\"btn btn-sm btn-primary js-multi-image__popover-btn-zoom mb-1 mr-1\" type=\"button\" data-hash=\"${\n\t\t\t\t\t\tfile.hash\n\t\t\t\t\t}\" data-js=\"click\"><i class=\"fa fa-search-plus\" title=\"${app.translate(\n\t\t\t\t'JS_ZOOM_IN'\n\t\t\t)}\"></i> <span class=\"c-btn-collapsible__text\"></span></button>\n\t\t\t\t</div>\n\t\t\t</div>`\n\t\t});\n\t}\n\n\t/**\n\t * Remove preview popover\n\t *\n\t * @param {String} hash\n\t */\n\tremovePreviewPopover(hash) {\n\t\tconst fileInfo = this.getFileInfo(hash);\n\t\tif (typeof fileInfo.previewElement !== 'undefined') {\n\t\t\tfileInfo.previewElement.popover('dispose');\n\t\t}\n\t}\n\n\t/**\n\t * Hide popovers when user starts moving file preview\n\t *\n\t * @param {Event} e\n\t * @param {Object} ui\n\t */\n\tsortOver(e, ui) {\n\t\tthis.elements.result.find('.js-multi-image__preview').popover('hide');\n\t}\n\n\t/**\n\t * Update file position according to elements order\n\t *\n\t * @param {Event} e\n\t * @param {Object} ui\n\t */\n\tsortStop(e, ui) {\n\t\tconst actualElements = this.elements.result.find('.js-multi-image__preview').toArray();\n\t\tthis.files = actualElements.map((element) => {\n\t\t\tfor (let i = 0, len = this.files.length; i < len; i++) {\n\t\t\t\tconst elementHash = $(element).data('hash');\n\t\t\t\tif (this.files[i].hash === elementHash) {\n\t\t\t\t\treturn this.files[i];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.redraw();\n\t}\n\n\t/**\n\t * Redraw view according to in-memory positions\n\t */\n\tredraw() {\n\t\tthis.files.forEach((file) => {\n\t\t\tthis.elements.result.append(file.previewElement);\n\t\t});\n\t\tthis.updateFormValues();\n\t}\n\n\t/**\n\t * Enable drag and drop files repositioning\n\t */\n\tenableDragNDrop() {\n\t\tthis.elements.result\n\t\t\t.sortable({\n\t\t\t\thandle: '.js-multi-image__preview-img',\n\t\t\t\titems: '.js-multi-image__preview',\n\t\t\t\tover: this.sortOver.bind(this),\n\t\t\t\tstop: this.sortStop.bind(this)\n\t\t\t})\n\t\t\t.disableSelection()\n\t\t\t.on('mousedown', '.js-multi-image__preview-img', function (e) {\n\t\t\t\tthis.focus(); // focus to show popover\n\t\t\t});\n\t}\n\tgeneratePreviewElements(files, callback) {\n\t\tfiles.forEach((file) => {\n\t\t\tif (file instanceof File) {\n\t\t\t\tlet template = $(this.generatePreviewFromFile(file));\n\t\t\t\tfile.preview = template;\n\t\t\t\tthis.addFileInfoProperty(file.hash, 'previewElement', file.preview);\n\t\t\t\tcallback(template);\n\t\t\t} else {\n\t\t\t\tthis.generatePreviewFromValue(file, (template, imageSrc) => {\n\t\t\t\t\tfile.preview = this.addPreviewPopover(file, template, imageSrc);\n\t\t\t\t\tthis.addFileInfoProperty(file.hash, 'previewElement', file.preview);\n\t\t\t\t\tcallback(file.preview);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Generate preview of image as html string\n\t *\n\t * @param {File} file\n\t * @param {function} callback\n\t */\n\tgeneratePreviewFromFile(file, callback) {\n\t\treturn `<div class=\"mr-1 js-multi-image__preview d-none\" id=\"js-multi-image__preview-hash-${\n\t\t\tfile.hash\n\t\t}\" data-hash=\"${file.hash}\" data-js=\"container|click\">\n\t\t\t<button class=\"btn btn-sm btn-danger c-btn-collapsible js-multi-image__popover-btn-delete mr-1\" type=\"button\" data-hash=\"${\n\t\t\t\tfile.hash\n\t\t\t}\" data-js=\"click\" title=\"${app.translate('JS_DELETE')}\"><i class=\"fa fa-trash-alt\"></i></button>${file.name}\n\t\t</div>`;\n\t}\n\n\t/**\n\t * Generate preview of image as html string from existing values\n\t *\n\t * @param {File} file\n\t * @param {function} callback\n\t */\n\tgeneratePreviewFromValue(file, callback) {\n\t\tcallback(\n\t\t\t`<div class=\"d-inline-block mr-1 js-multi-image__preview\" id=\"js-multi-image__preview-hash-${file.hash}\" data-hash=\"${file.hash}\" data-js=\"container|click\">\n\t\t\t\t<div class=\"img-thumbnail js-multi-image__preview-img c-multi-image__preview-img\" data-hash=\"${file.hash}\" data-js=\"drag\" style=\"background-image:url(${file.imageSrc})\" tabindex=\"0\" title=\"${file.name}\"></div>\n\t\t</div>`,\n\t\t\tfile.imageSrc\n\t\t);\n\t}\n\n\t/**\n\t * Load files that were in valueInput as json string\n\t */\n\tloadExistingFiles() {\n\t\tthis.files = this.files\n\t\t\t.map((file) => {\n\t\t\t\tfile.hash = this.generateRandomHash(CONFIG.userId);\n\t\t\t\treturn file;\n\t\t\t})\n\t\t\t.slice(0, this.options.limit);\n\t\tthis.generatePreviewElements(this.files, (element) => {\n\t\t\tthis.elements.result.append(element);\n\t\t});\n\t\tthis.updateFormValues();\n\t}\n\n\t/**\n\t * Generate carousel for all files in large preview\n\t *\n\t * @param {String} hash\n\t */\n\tgenerateCarousel(hash) {\n\t\tif (this.files.length <= 1) {\n\t\t\tconst fileInfo = this.getFileInfo(hash);\n\t\t\treturn `<img class=\"d-block w-100\" src=\"${fileInfo.imageSrc}\">`;\n\t\t}\n\t\tlet template = `<div id=\"carousel-${hash}\" class=\"carousel slide c-carousel\" data-ride=\"carousel\" data-js=\"container\">\n\t\t  <div class=\"carousel-inner\">`;\n\t\tthis.files.forEach((file) => {\n\t\t\ttemplate += `<div class=\"carousel-item c-carousel__item`;\n\t\t\tif (file.hash === hash) {\n\t\t\t\ttemplate += ` active`;\n\t\t\t}\n\t\t\ttemplate += `\" data-hash=\"${file.hash}\">\n\t\t      <img class=\"d-block w-100 c-carousel__image\" src=\"${file.imageSrc}\">\n\t\t    </div>`;\n\t\t});\n\t\ttemplate += `<a class=\"carousel-control-prev c-carousel__prevnext-btn c-carousel__prev-btn\" href=\"#carousel-${hash}\" role=\"button\" data-slide=\"prev\" data-js=\"click\">\n\t\t    <span class=\"fas fa-caret-left fa-2x c-carousel__prev-icon mr-1\" aria-hidden=\"true\"></span>\n\t\t  </a>\n\t\t  <a class=\"carousel-control-next c-carousel__prevnext-btn c-carousel__next-btn\" href=\"#carousel-${hash}\" role=\"button\" data-slide=\"next\" data-js=\"click\">\n\t\t    <span class=\"fas fa-caret-right fa-2x c-carousel__next-icon ml-1\" aria-hidden=\"true\"></span>\n\t\t  </a>\n\t\t</div>`;\n\t\treturn template;\n\t}\n\n\t/**\n\t * generate random hash\n\t * @returns {string}\n\t */\n\tgenerateRandomHash(prefix = '') {\n\t\tprefix = prefix.toString();\n\t\tconst hash =\n\t\t\tMath.random().toString(36).substr(2, 10) +\n\t\t\tMath.random().toString(36).substr(2, 10) +\n\t\t\tnew Date().valueOf() +\n\t\t\tMath.random().toString(36).substr(2, 6);\n\t\treturn prefix ? prefix + hash : hash;\n\t}\n}\n"],"names":["MultiImage","element","elements","options","showCarousel","detailView","fileInput","find","eq","length","component","form","closest","addButton","values","progressBar","progress","result","fieldInfo","data","formats","limit","files","JSON","parse","val","fileupload","dataType","replaceFileInput","autoUpload","add","bind","change","fail","uploadError","on","thisInstance","zoomPreview","$","e","preventDefault","download","deleteFile","loadExistingFiles","trigger","hash","i","len","file","app","errorLog","showNotify","text","translate","type","propertyName","value","fileInfo","getFileInfo","jqXHR","responseJSON","Fields","currentFileUploads","response","attach","Array","isArray","forEach","fileAttach","App","error","name","updateFormValues","formValues","map","key","size","stringify","format","valid","join","showLimitError","filter","validateFile","addedFiles","generateRandomHash","CONFIG","userId","push","imageSrc","parseInt","loaded","total","css","width","setTimeout","addClass","removeClass","substr","toLowerCase","downloadFile","downloadBase64","link","document","createElement","body","appendChild","href","click","removeChild","location","replace","imageUrl","split","titleTemplate","icon","setAttribute","titleObject","createTextNode","innerHTML","buttons","self","class","dismiss","showModalHtml","header","footerButtons","generateCarousel","cb","modal","hideModalWindow","relatedTarget","html","previewElement","popover","remove","showConfirmation","showConfirmModal","title","titleTrusted","confirmedCallback","deleteFileCallback","clearFilesInput","filterValidFiles","setFilesHash","generatePreviewElements","redraw","template","fileSize","deleteBtn","container","sanitize","placement","content","actualElements","toArray","elementHash","append","sortable","handle","items","over","sortOver","stop","sortStop","disableSelection","focus","callback","File","generatePreviewFromFile","preview","addFileInfoProperty","generatePreviewFromValue","addPreviewPopover","slice","prefix","toString","Math","random","valueOf"],"mappings":"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"}