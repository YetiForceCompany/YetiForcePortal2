'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
  return typeof obj;
} : function (obj) {
  return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
};

var classCallCheck = function (instance, Constructor) {
  if (!(instance instanceof Constructor)) {
    throw new TypeError("Cannot call a class as a function");
  }
};

var createClass = function () {
  function defineProperties(target, props) {
    for (var i = 0; i < props.length; i++) {
      var descriptor = props[i];
      descriptor.enumerable = descriptor.enumerable || false;
      descriptor.configurable = true;
      if ("value" in descriptor) descriptor.writable = true;
      Object.defineProperty(target, descriptor.key, descriptor);
    }
  }

  return function (Constructor, protoProps, staticProps) {
    if (protoProps) defineProperties(Constructor.prototype, protoProps);
    if (staticProps) defineProperties(Constructor, staticProps);
    return Constructor;
  };
}();

var inherits = function (subClass, superClass) {
  if (typeof superClass !== "function" && superClass !== null) {
    throw new TypeError("Super expression must either be null or a function, not " + typeof superClass);
  }

  subClass.prototype = Object.create(superClass && superClass.prototype, {
    constructor: {
      value: subClass,
      enumerable: false,
      writable: true,
      configurable: true
    }
  });
  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;
};

var possibleConstructorReturn = function (self, call) {
  if (!self) {
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  }

  return call && (typeof call === "object" || typeof call === "function") ? call : self;
};

/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */window.Base_Dashboard_MiniList_Js=function(){function _class(){classCallCheck(this,_class);}return createClass(_class,[{key:'registerEvents',value:function registerEvents(container){container.find('.js-row').on('click',function(){window.location.href=$(this).data('url');});}}]),_class}(),window.Base_Dashboard_ChartFilter_Js=function(){function _class2(){classCallCheck(this,_class2),this.container='',this.widgetData='',this.globalChartFunctions={/**
			 * Functions for x or y axes scales xAxes:[{here}]
			 */scales:{formatAxesLabels:function(value){return 0<String(value).length&&!isNaN(Number(value))?App.Fields.Double.formatToDisplay(value):value}},/**
			 * Functions for datalabels
			 */datalabels:{display:function display(context){var meta=context.chart.getDatasetMeta(context.datasetIndex);return !0!==meta.hidden},formatter:function(value,context){return 'undefined'!=typeof this.widgetData&&'undefined'!=typeof this.widgetData.valueType&&'count'===this.widgetData.valueType?App.Fields.Double.formatToDisplay(value,0):'undefined'!=typeof context.chart.data.datasets[context.datasetIndex].dataFormatted&&'undefined'!=typeof context.chart.data.datasets[context.datasetIndex].dataFormatted[context.dataIndex]?context.chart.data.datasets[context.datasetIndex].dataFormatted[context.dataIndex]:0<String(value).length&&isNaN(Number(value))?App.Fields.Double.formatToDisplay(value):value}},/**
			 * Tooltips functions
			 */tooltips:{label:function(tooltipItem,data){// get already formatted data if exists
// return raw data at idex
return 'undefined'!=typeof data.datasets[tooltipItem.datasetIndex].dataFormatted&&'undefined'!==data.datasets[tooltipItem.datasetIndex].dataFormatted[tooltipItem.index]?data.datasets[tooltipItem.datasetIndex].dataFormatted[tooltipItem.index]:0<String(data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index]).length&&!isNaN(Number(data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index]))?'undefined'!=typeof this.widgetData&&'undefined'!=typeof this.widgetData.valueType&&'count'===this.widgetData.valueType?App.Fields.Double.formatToDisplay(data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index],0):App.Fields.Double.formatToDisplay(data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index]):data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];// if there is no formatted data so try to format it
},title:function(tooltipItems,data){var tooltipItem=tooltipItems[0];// get already formatted title if exists
// return label at index
return 'undefined'!=typeof data.datasets[tooltipItem.datasetIndex].titlesFormatted&&'undefined'!==data.datasets[tooltipItem.datasetIndex].titlesFormatted[tooltipItem.index]?data.datasets[tooltipItem.datasetIndex].titlesFormatted[tooltipItem.index]:0<String(data.labels[tooltipItem.index]).length&&!isNaN(Number(data.labels[tooltipItem.index]))?'undefined'!=typeof this.widgetData&&'undefined'!=typeof this.widgetData.valueType&&'count'===this.widgetData.valueType?App.Fields.Double.formatToDisplay(data.labels[tooltipItem.index],0):App.Fields.Double.formatToDisplay(data.labels[tooltipItem.index]):data.labels[tooltipItem.index];// if there is no formatted title so try to format it
}},legend:{onClick:function onClick(e,legendItem){var type=this.chartInstance.config.type;return 'undefined'==typeof Chart.defaults[type]?Chart.defaults.global.legend.onClick.apply(this.chartInstance,[e,legendItem]):Chart.defaults[type].legend.onClick.apply(this.chartInstance,[e,legendItem])},generateLabels:function generateLabels(chart){var type=chart.config.type,labels=void 0;return labels='undefined'==typeof Chart.defaults[type]?Chart.defaults.global.legend.labels.generateLabels(chart):Chart.defaults[type].legend.labels.generateLabels(chart),(this.areColorsFromDividingField()||this.isMultiFilter())&&(chart.config.options.legend.labels.boxWidth=12,labels.forEach(function(label){label.fillStyle='rgba(0,0,0,0)',label.strokeStyle='rgba(0,0,0,0.15)';})),labels},display:function display(){return !!(this.isMultiFilter()||this.areColorsFromDividingField())}},/**
			 * plugins
			 */plugins:{/**
				 * If datalabels doesn't fit - hide them individually
				 * @param  {Chart} chart chart instance
				 * @return {undefined}
				 */hideVerticalBarDatalabelsIfNeeded:function hideVerticalBarDatalabelsIfNeeded(chart){for(var getDatasetsMeta=function(chart){var datasets=[],data=chart.data;if('undefined'!=typeof data&&'undefined'!=typeof data.datasets&&Array.isArray(data.datasets))for(var meta,i=0,len=data.datasets.length;i<len;i++)meta=chart.getDatasetMeta(i),'undefined'!=typeof meta.data&&Array.isArray(meta.data)&&datasets.push(meta);return datasets},datasetsMeta=getDatasetsMeta(chart),datasets=chart.data.datasets,i=0,len=datasets.length;i<len;i++){var dataset=datasets[i],meta=datasetsMeta[i];if(!meta.hidden){var metaData=meta.data;'undefined'==typeof dataset._models&&(dataset._models={}),'undefined'==typeof dataset.datalabels&&(dataset.datalabels={}),'undefined'==typeof dataset.datalabels.display&&(dataset.datalabels.display=!0);for(var dataItem,iItem=0,lenItem=metaData.length;iItem<lenItem;iItem++)if(dataItem=metaData[iItem],'undefined'!=typeof dataItem.$datalabels&&'undefined'!=typeof dataItem.$datalabels._model){var model=dataItem.$datalabels._model;if(null!==model&&'undefined'!=typeof model)dataset._models[iItem]=model;else if(null!==dataset._models[iItem]&&'undefined'!=typeof dataset._models[iItem])model=dataset._models[iItem];else return !1;var labelWidth=model.size.width+model.padding.width+2*model.borderWidth,labelHeight=model.size.height+model.padding.height+2*model.borderWidth,barHeight=dataItem.height(),threshold=10;'undefined'!=typeof chart.config.options.verticalBarLabelsThreshold&&(threshold=chart.config.options.verticalBarLabelsThreshold),dataItem._view.width+threshold<labelWidth||barHeight+threshold<labelHeight?dataItem.$datalabels._model.positioner=function(){return !1}:dataItem.$datalabels._model=model;}}}},/**
				 * If datalabels doesn't fit - hide them individually
				 * @param  {Chart} chart  Chart instance
				 * @return {undefined}
				 */hideHorizontalBarDatalabelsIfNeeded:function(chart){for(var getDatasetsMeta=function(chart){var datasets=[],data=chart.data;if('undefined'!=typeof data&&'undefined'!=typeof data.datasets&&Array.isArray(data.datasets))for(var meta,i=0,len=data.datasets.length;i<len;i++)meta=chart.getDatasetMeta(i),'undefined'!=typeof meta.data&&Array.isArray(meta.data)&&datasets.push(meta);return datasets},datasetsMeta=getDatasetsMeta(chart),datasets=chart.data.datasets,i=0,len=datasets.length;i<len;i++){var dataset=datasets[i],meta=datasetsMeta[i];if(!meta.hidden){var metaData=meta.data;'undefined'==typeof dataset._models&&(dataset._models={}),'undefined'==typeof dataset.datalabels&&(dataset.datalabels={}),'undefined'==typeof dataset.datalabels.display&&(dataset.datalabels.display=!0);for(var dataItem,iItem=0,lenItem=metaData.length;iItem<lenItem;iItem++)if(dataItem=metaData[iItem],'undefined'!=typeof dataItem.$datalabels&&'undefined'!=typeof dataItem.$datalabels._model){var model=dataItem.$datalabels._model;if(null!==model&&'undefined'!=typeof model)dataset._models[iItem]=model;else if(null!==dataset._models[iItem]&&'undefined'!=typeof dataset._models[iItem])model=dataset._models[iItem];else return !1;var labelWidth=model.size.width+model.padding.width+2*model.borderWidth,labelHeight=model.size.height+model.padding.height+2*model.borderWidth,barWidth=dataItem.width,threshold=10;'undefined'!=typeof chart.config.options.horizontalBarLabelsThreshold&&(threshold=chart.config.options.horizontalBarLabelsThreshold),dataItem._view.height+threshold<labelHeight||barWidth+threshold<labelWidth?dataItem.$datalabels._model.positioner=function(){return !1}:dataItem.$datalabels._model=model;}}}},/**
				 * Fix to long axis labels
				 * @param  {Chart}  chart    Chart instance
				 * @return {Boolean}       [description]
				 */fixXAxisLabels:function(chart){var shortenXTicks=function(data,options){return 'undefined'==typeof options.scales&&(options.scales={}),'undefined'==typeof options.scales.xAxes&&(options.scales.xAxes=[{}]),options.scales.xAxes.forEach(function(axis){'undefined'==typeof axis.ticks&&(axis.ticks={}),axis.ticks.callback=function(value){return 13<value.length?value.substr(0,10)+'...':value};}),options},rotateXLabels90=function(data,options){return 'undefined'==typeof options.scales&&(options.scales={}),'undefined'==typeof options.scales.xAxes&&(options.scales.xAxes=[{}]),options.scales.xAxes.forEach(function(axis){'undefined'==typeof axis.ticks&&(axis.ticks={}),axis.ticks.minRotation=90;}),options};chart.data.datasets.forEach(function(dataset){if(dataset._updated)return !1;var _loop=function(prop){if(dataset._meta.hasOwnProperty(prop)){for(var i=0,len=dataset._meta[prop].data.length;i<len;i++){var metaDataItem=dataset._meta[prop].data[i],label=metaDataItem._xScale.ticks[i],ctx=metaDataItem._xScale.ctx,categoryWidth=metaDataItem._xScale.width/dataset._meta[prop].data.length;'undefined'!=typeof metaDataItem._xScale.options.categoryPercentage&&(categoryWidth*=metaDataItem._xScale.options.categoryPercentage);var fullWidth=ctx.measureText(label).width;if(categoryWidth<fullWidth){var shortened=label.substr(0,10)+'...',shortenedWidth=ctx.measureText(shortened).width;if(categoryWidth<shortenedWidth?(chart.options=rotateXLabels90(chart.data,chart.options),chart.options=shortenXTicks(chart.data,chart.options)):chart.options=shortenXTicks(chart.data,chart.options),!dataset._updated){dataset._updated=!0,chart.update(),chart.data.datasets.forEach(function(dataset,index){dataset._meta[prop].data.forEach(function(metaDataItem,dataIndex){metaDataItem._view.x=metaDataItem._xScale.getPixelForValue(index,dataIndex),metaDataItem._view.base=metaDataItem._xScale.getBasePixel(),metaDataItem._view.width=metaDataItem._xScale.width/dataset._meta[prop].data.length*metaDataItem._xScale.options.categoryPercentage*metaDataItem._xScale.options.barPercentage;});});break}}}dataset._updated=!0;}};for(var prop in dataset._meta)_loop(prop);});},/**
				 * Fix too long axis labels  - try to shorten and rotate
				 * @param  {Chart}  chart    Chart instance
				 * @return {Boolean}
				 */fixYAxisLabels:function(chart){var shortenYTicks=function(data,options){return 'undefined'==typeof options.scales&&(options.scales={}),'undefined'==typeof options.scales.yAxes&&(options.scales.yAxes=[{}]),options.scales.yAxes.forEach(function(axis){'undefined'==typeof axis.ticks&&(axis.ticks={}),axis.ticks.callback=function(value){return 13<value.length?value.substr(0,10)+'...':value};}),options};chart.data.datasets.forEach(function(dataset){if(dataset._updated)return !1;var _loop2=function(prop){if(dataset._meta.hasOwnProperty(prop)){// we have meta
for(var i=0,len=dataset._meta[prop].data.length;i<len;i++){var metaDataItem=dataset._meta[prop].data[i],label=metaDataItem._view.label;if(13<label.length&&(chart.options=shortenYTicks(chart.data,chart.options),!dataset._updated)){dataset._updated=!0,chart.update(),chart.data.datasets.forEach(function(dataset,index){dataset._meta[prop].data.forEach(function(metaDataItem,dataIndex){'undefined'!=typeof metaDataItem._xScale&&(metaDataItem._view.x=metaDataItem._xScale.getPixelForValue(index,dataIndex),metaDataItem._view.base=metaDataItem._xScale.getBasePixel(),metaDataItem._view.width=metaDataItem._xScale.width/dataset._meta[prop].data.length*metaDataItem._xScale.options.categoryPercentage*metaDataItem._xScale.options.barPercentage);});});break}}dataset._updated=!0;}};for(var prop in dataset._meta)_loop2(prop);});}}};}return createClass(_class2,[{key:'setChartContainer',value:function setChartContainer(container){this.container=container;}},{key:'getChartContainer',value:function getChartContainer(){return this.container}},{key:'getWidgetData',value:function getWidgetData(){if('undefined'!=typeof this.widgetData&&''!==this.widgetData)return this.widgetData;var widgetDataEl=this.getChartContainer().find('[name="widgetData"]');return !!widgetDataEl.length&&(this.widgetData=JSON.parse(widgetDataEl.val()))}},{key:'getGlobalDefaultChartsOptions',value:function getGlobalDefaultChartsOptions(chartSubType){var options={bar:{basic:{maintainAspectRatio:!1,title:{display:!1},legend:{display:'function:legend.display()'},tooltips:{mode:'point',callbacks:{label:'function:tooltips.label',title:'function:tooltips.title'}},scales:{xAxes:[{ticks:{autoSkip:!1,beginAtZero:!0,maxRotation:90,callback:'function:scales.formatAxesLabels'}}],yAxes:[{ticks:{autoSkip:!1,beginAtZero:!0,callback:'function:scales.formatAxesLabels'}}]}},dataset:{datalabels:{font:{size:11},color:'white',backgroundColor:'rgba(0,0,0,0.2)',borderColor:'rgba(255,255,255,0.2)',borderWidth:2,borderRadius:2,anchor:'center',align:'center',formatter:'function:datalabels.formatter',display:'function:datalabels.display'}},plugins:[{beforeDraw:'function:plugins.fixXAxisLabels'},{beforeDraw:'function:plugins.hideVerticalBarDatalabelsIfNeeded'}]},barStacked:{basic:{maintainAspectRatio:!1,title:{display:!1},legend:{display:'function:legend.display()'},tooltips:{mode:'point',callbacks:{label:'function:tooltips.label',title:'function:tooltips.title'}},scales:{xAxes:[{stacked:!0,ticks:{autoSkip:!1,beginAtZero:!0,maxRotation:90,callback:'function:scales.formatAxesLabels'}}],yAxes:[{stacked:!0,ticks:{autoSkip:!1,beginAtZero:!0,callback:'function:scales.formatAxesLabels'}}]}},dataset:{datalabels:{font:{size:11},color:'white',backgroundColor:'rgba(0,0,0,0.2)',borderColor:'rgba(255,255,255,0.2)',borderWidth:2,borderRadius:2,anchor:'center',align:'center',formatter:'function:datalabels.formatter',display:'function:datalabels.display'}},plugins:[{beforeDraw:'function:plugins.fixXAxisLabels'},{beforeDraw:'function:plugins.hideVerticalBarDatalabelsIfNeeded'}]},horizontalBar:{basic:{maintainAspectRatio:!1,title:{display:!1},legend:{display:'function:legend.display()'},tooltips:{mode:'point',callbacks:{label:'function:tooltips.label',title:'function:tooltips.title'}},scales:{xAxes:[{ticks:{autoSkip:!1,beginAtZero:!0,maxRotation:90,callback:'function:scales.formatAxesLabels'}}],yAxes:[{ticks:{autoSkip:!1,beginAtZero:!0,callback:'function:scales.formatAxesLabels'}}]}},dataset:{datalabels:{font:{size:11},color:'white',backgroundColor:'rgba(0,0,0,0.2)',borderColor:'rgba(255,255,255,0.2)',borderWidth:2,borderRadius:2,anchor:'center',align:'center',formatter:'function:datalabels.formatter',display:'function:datalabels.display'}},plugins:[{beforeDraw:'function:plugins.fixYAxisLabels'},{beforeDraw:'function:plugins.hideHorizontalBarDatalabelsIfNeeded'}]},horizontalBarStacked:{basic:{maintainAspectRatio:!1,title:{display:!1},legend:{display:'function:legend.display()'},tooltips:{mode:'point',callbacks:{label:'function:tooltips.label',title:'function:tooltips.title'}},scales:{xAxes:[{stacked:!0,ticks:{autoSkip:!1,beginAtZero:!0,maxRotation:90,callback:'function:scales.formatAxesLabels'}}],yAxes:[{stacked:!0,ticks:{autoSkip:!1,beginAtZero:!0,callback:'function:scales.formatAxesLabels'}}]}},dataset:{datalabels:{font:{size:11},color:'white',backgroundColor:'rgba(0,0,0,0.2)',borderColor:'rgba(255,255,255,0.2)',borderWidth:2,borderRadius:2,anchor:'center',align:'center',formatter:'function:datalabels.formatter',display:'function:datalabels.display'}},plugins:[{beforeDraw:'function:plugins.fixYAxisLabels'},{beforeDraw:'function:plugins.hideHorizontalBarDatalabelsIfNeeded'}]},line:{basic:{maintainAspectRatio:!1,title:{display:!1},legend:{display:'function:legend.display()'},tooltips:{mode:'point',callbacks:{label:'function:tooltips.label',title:'function:tooltips.title'}},scales:{xAxes:[{ticks:{autoSkip:!1,beginAtZero:!0,maxRotation:90,callback:'function:scales.formatAxesLabels',labelOffset:0}}],yAxes:[{ticks:{autoSkip:!1,beginAtZero:!0,callback:'function:scales.formatAxesLabels'}}]}},dataset:{fill:!1,datalabels:{font:{size:11},color:'white',backgroundColor:'rgba(0,0,0,0.5)',borderColor:'rgba(255,255,255,0.5)',borderWidth:2,borderRadius:2,anchor:'bottom',align:'bottom',formatter:'function:datalabels.formatter',display:'function:datalabels.display'}},plugins:[{beforeDraw:'function:plugins.fixXAxisLabels'}]},lineStacked:{basic:{maintainAspectRatio:!1,title:{display:!1},legend:{display:'function:legend.display()'},tooltips:{mode:'point',callbacks:{label:'function:tooltips.label',title:'function:tooltips.title'}},scales:{xAxes:[{ticks:{autoSkip:!1,beginAtZero:!0,maxRotation:90,callback:'function:scales.formatAxesLabels',labelOffset:0}}],yAxes:[{stacked:!0,ticks:{autoSkip:!1,beginAtZero:!0,callback:'function:scales.formatAxesLabels'}}]}},dataset:{fill:!1,datalabels:{font:{size:11},color:'white',backgroundColor:'rgba(0,0,0,0.5)',borderColor:'rgba(255,255,255,0.5)',borderWidth:2,borderRadius:2,anchor:'bottom',align:'bottom',formatter:'function:datalabels.formatter',display:'function:datalabels.display'}},plugins:[{beforeDraw:'function:plugins.fixXAxisLabels'}]},linePlain:{basic:{maintainAspectRatio:!1,title:{display:!1},legend:{display:'function:legend.display()'},tooltips:{mode:'point',callbacks:{label:'function:tooltips.label',title:'function:tooltips.title'}},scales:{xAxes:[{ticks:{autoSkip:!1,beginAtZero:!0,maxRotation:90,callback:'function:scales.formatAxesLabels',labelOffset:0}}],yAxes:[{ticks:{autoSkip:!1,beginAtZero:!0,callback:'function:scales.formatAxesLabels'}}]}},dataset:{lineTension:0,fill:!1,datalabels:{font:{size:11},color:'white',backgroundColor:'rgba(0,0,0,0.5)',borderColor:'rgba(255,255,255,0.5)',borderWidth:2,borderRadius:2,anchor:'bottom',align:'bottom',formatter:'function:datalabels.formatter',display:'function:datalabels.display'}},plugins:[{beforeDraw:'function:plugins.fixXAxisLabels'}]},linePlainStacked:{basic:{maintainAspectRatio:!1,title:{display:!1},legend:{display:'function:legend.display()'},tooltips:{mode:'point',callbacks:{label:'function:tooltips.label',title:'function:tooltips.title'}},scales:{xAxes:[{ticks:{autoSkip:!1,beginAtZero:!0,maxRotation:90,callback:'function:scales.formatAxesLabels',labelOffset:0}}],yAxes:[{stacked:!0,ticks:{autoSkip:!1,beginAtZero:!0,callback:'function:scales.formatAxesLabels'}}]}},dataset:{fill:!1,lineTension:0,datalabels:{font:{size:11},color:'white',backgroundColor:'rgba(0,0,0,0.5)',borderColor:'rgba(255,255,255,0.5)',borderWidth:2,borderRadius:2,anchor:'bottom',align:'bottom',formatter:'function:datalabels.formatter',display:'function:datalabels.display'}},plugins:[{beforeDraw:'function:plugins.fixXAxisLabels'}]},pie:{basic:{maintainAspectRatio:!1,title:{display:!1},legend:{display:!0,labels:{generateLabels:'function:legend.generateLabels'}},cutoutPercentage:0,layout:{padding:{bottom:12}},tooltips:{mode:'point',callbacks:{label:'function:tooltips.label',title:'function:tooltips.title'}},scales:{}},dataset:{datalabels:{font:{size:11},color:'white',backgroundColor:'rgba(0,0,0,0.5)',borderColor:'rgba(255,255,255,0.5)',borderWidth:2,borderRadius:4,anchor:'end',align:'center',formatter:'function:datalabels.formatter',display:'function:datalabels.display'}},plugins:[]},doughnut:{basic:{maintainAspectRatio:!1,title:{display:!1},legend:{display:!0,onClick:'function:legend.onClick',labels:{generateLabels:'function:legend.generateLabels'}},cutoutPercentage:50,layout:{padding:{bottom:12}},tooltips:{mode:'point',callbacks:{label:'function:tooltips.label',title:'function:tooltips.title'}},scales:{}},dataset:{datalabels:{font:{size:11},color:'white',backgroundColor:'rgba(0,0,0,0.5)',borderColor:'rgba(255,255,255,0.5)',borderWidth:2,borderRadius:4,anchor:'end',align:'center',formatter:'function:datalabels.formatter',display:'function:datalabels.display'}},plugins:[]},funnel:{basic:{maintainAspectRatio:!1,title:{display:!1},legend:{display:!1},sort:'desc',tooltips:{mode:'point',callbacks:{label:'function:tooltips.label',title:'function:tooltips.title'}},scales:{yAxes:[{display:!0,beginAtZero:!0,ticks:{callback:'function:scales.formatAxesLabels'}}]}},dataset:{datalabels:{display:!1}},plugins:[{beforeDraw:'function:plugins.fixYAxisLabels'}]}};if('undefined'!=typeof options[chartSubType])return options[chartSubType];// if divided and standard chart types are equal
var notStackedChartSubType=this.removeStackedFromName(chartSubType);return 'undefined'==typeof options[notStackedChartSubType]?void app.errorLog(new Error(chartSubType+' chart does not exists!')):options[notStackedChartSubType]}},{key:'getDefaultDatasetOptions',value:function getDefaultDatasetOptions(chartSubType){return this.getGlobalDefaultChartsOptions(chartSubType).dataset}},{key:'mergeOptionsArray',value:function mergeOptionsArray(to,fromArray){var _this=this;if('undefined'!=typeof to)return to;to=[];var result=fromArray.map(function(from,index){return Array.isArray(from)&&!to.hasOwnProperty(key)?_this.mergeOptionsArray(to[index],from):'object'===('undefined'==typeof from?'undefined':_typeof(from))&&null!==from&&('undefined'==typeof to[index]||'object'===_typeof(to[index])&&null!==to[index])?_this.mergeOptionsObject(to[index],from):to[index]}).filter(function(item){return 'undefined'!=typeof item});return result}},{key:'mergeOptionsObject',value:function mergeOptionsObject(to,from){for(var _key in 'undefined'==typeof to&&(to={}),from)from.hasOwnProperty(_key)&&(Array.isArray(from[_key])?!to.hasOwnProperty(_key)&&(to[_key]=this.mergeOptionsArray(void 0,from[_key])):'object'!==_typeof(from[_key])||null===from[_key]||to.hasOwnProperty(_key)&&('object'!==_typeof(to[_key])||null===to[_key]||Array.isArray(to[_key]))?!to.hasOwnProperty(_key)&&(to[_key]=from[_key]):to[_key]=this.mergeOptionsObject(to[_key],from[_key]));return to}},{key:'mergeOptions',value:function mergeOptions(){for(var to=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},_len=arguments.length,fromArray=Array(1<_len?_len-1:0),_key2=1;_key2<_len;_key2++)fromArray[_key2-1]=arguments[_key2];for(var i=0,len=fromArray.length;i<len;i++)'object'!==_typeof(fromArray[i])||Array.isArray(fromArray[i])?app.errorLog(new Error('Options argument should be an object! Chart subType: '+this.getSubType()+' ['+fromArray[i].toString()+']')):to=this.mergeOptionsObject(to,fromArray[i]);return to}},{key:'loadDatasetOptions',value:function loadDatasetOptions(chartData){var _this2=this;return chartData.datasets.map(function(dataset){var result=_this2.mergeOptions(dataset,{},_this2.getDefaultDatasetOptions(_this2.getSubType()));return result})}},{key:'formatTooltipLabels',value:function formatTooltipLabels(data){var _this3=this;data.datasets.forEach(function(dataset){'undefined'==typeof dataset.dataFormatted&&(dataset.dataFormatted=[],dataset.data.forEach(function(dataItem){var dataFormatted=dataItem;0<String(dataItem).length&&!isNaN(Number(dataItem))&&('undefined'!=typeof _this3.widgetData&&'undefined'!=typeof _this3.widgetData.valueType&&'count'===_this3.widgetData.valueType?dataFormatted=App.Fields.Double.formatToDisplay(dataItem,0):dataFormatted=App.Fields.Double.formatToDisplay(dataItem)),dataset.dataFormatted.push(dataFormatted);}));});}},{key:'formatTooltipTitles',value:function formatTooltipTitles(data){var _this4=this;data.datasets.forEach(function(dataset){'undefined'==typeof dataset.titlesFormatted&&(dataset.titlesFormatted=[],dataset.data.forEach(function(dataItem,index){var defaultLabel=data.labels[index];if(0<String(defaultLabel).length&&!isNaN(Number(defaultLabel))&&('undefined'!=typeof _this4.widgetData&&'undefined'!=typeof _this4.widgetData.valueType&&'count'===_this4.widgetData.valueType?defaultLabel=App.Fields.Double.formatToDisplay(defaultLabel,0):defaultLabel=App.Fields.Double.formatToDisplay(defaultLabel)),'undefined'!=typeof dataset.label){var label=dataset.label;0<String(label).length&&!isNaN(Number(label))&&('undefined'!=typeof _this4.widgetData&&'undefined'!=typeof _this4.widgetData.valueType&&'count'===_this4.widgetData.valueType?label=App.Fields.Double.formatToDisplay(label,0):label=App.Fields.Double.formatToDisplay(label)),defaultLabel+=' ('+label+')';}dataset.titlesFormatted.push(defaultLabel);}));});}},{key:'getBasicOptions',value:function getBasicOptions(){return {responsive:!0,maintainAspectRatio:!1}}},{key:'getDefaultBasicOptions',value:function getDefaultBasicOptions(chartSubType){return this.getGlobalDefaultChartsOptions(chartSubType).basic}},{key:'loadBasicOptions',value:function loadBasicOptions(chartData){return this.formatTooltipTitles(chartData),this.formatTooltipLabels(chartData),this.mergeOptions(this.getBasicOptions(),this.getDefaultBasicOptions(this.getSubType()))}},{key:'getSubType',value:function getSubType(){return this.getType()}},{key:'isReplacementString',value:function isReplacementString(str){return 'string'==typeof str&&'function:'===str.substr(0,9)}},{key:'isMultiFilter',value:function isMultiFilter(){return 'undefined'!=typeof this.filterIds&&1<this.filterIds.length}},{key:'areColorsFromDividingField',value:function areColorsFromDividingField(){return !!Number(this.getChartContainer().find('[name="colorsFromDividingField"]').val())}},{key:'getFunctionFromReplacementString',value:function getFunctionFromReplacementString(replacementStr){var assignResult=!1;'()'===replacementStr.substr(replacementStr.length-2)&&(replacementStr=replacementStr.substr(0,replacementStr.length-2),assignResult=!0);var splitted=replacementStr.split(':');2!==splitted.length&&app.errorLog(new Error('Function replacement string should look like \'function:path.to.fn\' not like \''+replacementStr+'\''));var finalFunction=splitted[1].split('.').reduce(function(previous,current){return previous[current]},this.globalChartFunctions);return 'function'!=typeof finalFunction&&app.errorLog(new Error('Global function does not exists: '+splitted[1])),assignResult?finalFunction.call(this):finalFunction.bind(this)}},{key:'parseOptionsArray',value:function parseOptionsArray(arr,original){var _this5=this,afterInit=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];return arr.map(function(item){return _this5.isReplacementString(item)?_this5.getFunctionFromReplacementString(value):Array.isArray(item)?_this5.parseOptionsArray(item,original,afterInit):'object'===('undefined'==typeof item?'undefined':_typeof(item))&&null!==item?_this5.parseOptionsObject(item,original,afterInit):item})}},{key:'parseOptionsObject',value:function parseOptionsObject(options,original){var afterInit=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],result={};for(var propertyName in options){var _value=options[propertyName];result[propertyName]=afterInit?'_'===propertyName.substr(0,1)?_value:Array.isArray(_value)?this.parseOptionsArray(_value,original,afterInit):'object'===('undefined'==typeof _value?'undefined':_typeof(_value))&&null!==_value?this.parseOptionsObject(_value,original,afterInit):_value:'_'===propertyName.substr(0,1)?_value:this.isReplacementString(_value)?this.getFunctionFromReplacementString(_value,afterInit,original):Array.isArray(_value)?this.parseOptionsArray(_value,original,afterInit):'object'===('undefined'==typeof _value?'undefined':_typeof(_value))&&null!==_value?this.parseOptionsObject(_value,original,afterInit):_value;}return result}},{key:'parseOptions',value:function parseOptions(options,original){var afterInit=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];return Array.isArray(options)?this.parseOptionsArray(options,original,afterInit):'object'===('undefined'==typeof options?'undefined':_typeof(options))&&null!==options?this.parseOptionsObject(options,original,afterInit):void app.errorLog(new Error('Unknown options format ['+('undefined'==typeof options?'undefined':_typeof(options))+'] - should be object.'))}},{key:'loadPlugins',value:function loadPlugins(chartData){return this.mergeOptionsArray(this.getPlugins(chartData),this.getDefaultPlugins(this.getSubType(),chartData))}/**
	 * Load and display chart into the view
	 *
	 * @return {Chart} chartInstance
	 */},{key:'loadChart',value:function loadChart(){var _this6=this;if('undefined'==typeof this.getChartContainer())return !1;var data=this.getWidgetData(),type=this.getType();// load widget data for label formatters
data.datasets=this.loadDatasetOptions(data);var options=this.parseOptions(this.loadBasicOptions(data));data=this.parseOptions(data);var chart=this.chartInstance=new Chart(this.getChartContainer().find('canvas').get(0).getContext('2d'),{type:type,data:data,options:options,plugins:[]});// parse chart one more time after it was mounted - some options need to have chart loaded
return data.datasets=data.datasets.map(function(dataset,index){return dataset.datasetIndex=index,_this6.parseOptions(dataset,dataset,!0)}),chart}},{key:'readData',value:function readData(){var container=this.getChartContainer();this.filterIds=JSON.parse(container.find('[name="filterIds"]').val());}},{key:'registerEvents',value:function registerEvents(container){var type=container.find('[name="typeChart"]').val(),stacked=!!Number(container.find('[name="stacked"]').val());stacked&&(type+='Stacked');var classname='Base_Dashboard_ChartFilter_'+type+'_Js';if('undefined'!=typeof window[classname]){var instance=new window[classname];return instance.setChartContainer(container),instance.readData(),instance.loadChart()}console.error('Nie znaleziono '+classname);}}]),_class2}(),window.Base_Dashboard_ChartFilter_Pie_Js=function(_Base_Dashboard_Chart){function _class3(){return classCallCheck(this,_class3),possibleConstructorReturn(this,(_class3.__proto__||Object.getPrototypeOf(_class3)).apply(this,arguments))}return inherits(_class3,_Base_Dashboard_Chart),createClass(_class3,[{key:'getType',value:function getType(){return 'pie'}}]),_class3}(Base_Dashboard_ChartFilter_Js),window.Base_Dashboard_ChartFilter_Bar_Js=function(_Base_Dashboard_Chart2){function _class4(){return classCallCheck(this,_class4),possibleConstructorReturn(this,(_class4.__proto__||Object.getPrototypeOf(_class4)).apply(this,arguments))}return inherits(_class4,_Base_Dashboard_Chart2),createClass(_class4,[{key:'getType',value:function getType(){return 'bar'}}]),_class4}(Base_Dashboard_ChartFilter_Js),window.Base_Dashboard_ChartFilter_BarStacked_Js=function(_Base_Dashboard_Chart3){function _class5(){return classCallCheck(this,_class5),possibleConstructorReturn(this,(_class5.__proto__||Object.getPrototypeOf(_class5)).apply(this,arguments))}return inherits(_class5,_Base_Dashboard_Chart3),createClass(_class5,[{key:'getType',value:function getType(){return 'barStacked'}}]),_class5}(Base_Dashboard_ChartFilter_Js),window.Base_Dashboard_ChartFilter_Horizontal_Js=function(_Base_Dashboard_Chart4){function _class6(){return classCallCheck(this,_class6),possibleConstructorReturn(this,(_class6.__proto__||Object.getPrototypeOf(_class6)).apply(this,arguments))}return inherits(_class6,_Base_Dashboard_Chart4),createClass(_class6,[{key:'getType',value:function getType(){return 'horizontalBar'}}]),_class6}(Base_Dashboard_ChartFilter_Bar_Js),window.Base_Dashboard_ChartFilter_HorizontalStacked_Js=function(_Base_Dashboard_Chart5){function _class7(){return classCallCheck(this,_class7),possibleConstructorReturn(this,(_class7.__proto__||Object.getPrototypeOf(_class7)).apply(this,arguments))}return inherits(_class7,_Base_Dashboard_Chart5),createClass(_class7,[{key:'getType',value:function getType(){return 'horizontalBar'}},{key:'getSubType',value:function getSubType(){return 'horizontalBarStacked'}}]),_class7}(Base_Dashboard_ChartFilter_Horizontal_Js),window.Base_Dashboard_ChartFilter_Funnel_Js=function(_Base_Dashboard_Chart6){function _class8(){return classCallCheck(this,_class8),possibleConstructorReturn(this,(_class8.__proto__||Object.getPrototypeOf(_class8)).apply(this,arguments))}return inherits(_class8,_Base_Dashboard_Chart6),createClass(_class8,[{key:'getType',value:function getType(){return 'funnel'}}]),_class8}(Base_Dashboard_ChartFilter_Js),window.Base_Dashboard_ChartFilter_Donut_Js=function(_Base_Dashboard_Chart7){function _class9(){return classCallCheck(this,_class9),possibleConstructorReturn(this,(_class9.__proto__||Object.getPrototypeOf(_class9)).apply(this,arguments))}return inherits(_class9,_Base_Dashboard_Chart7),createClass(_class9,[{key:'getType',value:function getType(){return 'doughnut'}}]),_class9}(Base_Dashboard_ChartFilter_Pie_Js),window.Base_Dashboard_ChartFilter_Line_Js=function(_Base_Dashboard_Chart8){function _class10(){return classCallCheck(this,_class10),possibleConstructorReturn(this,(_class10.__proto__||Object.getPrototypeOf(_class10)).apply(this,arguments))}return inherits(_class10,_Base_Dashboard_Chart8),createClass(_class10,[{key:'getType',value:function getType(){return 'line'}}]),_class10}(Base_Dashboard_ChartFilter_Js),window.Base_Dashboard_ChartFilter_LineStacked_Js=function(_Base_Dashboard_Chart9){function _class11(){return classCallCheck(this,_class11),possibleConstructorReturn(this,(_class11.__proto__||Object.getPrototypeOf(_class11)).apply(this,arguments))}return inherits(_class11,_Base_Dashboard_Chart9),createClass(_class11,[{key:'getType',value:function getType(){return 'line'}},{key:'getSubType',value:function getSubType(){return 'lineStacked'}}]),_class11}(Base_Dashboard_ChartFilter_Line_Js),window.Base_Dashboard_ChartFilter_LinePlain_Js=function(_Base_Dashboard_Chart10){function _class12(){return classCallCheck(this,_class12),possibleConstructorReturn(this,(_class12.__proto__||Object.getPrototypeOf(_class12)).apply(this,arguments))}return inherits(_class12,_Base_Dashboard_Chart10),createClass(_class12,[{key:'getSubType',value:function getSubType(){return 'linePlain'}}]),_class12}(Base_Dashboard_ChartFilter_Line_Js),window.Base_Dashboard_ChartFilter_LinePlainStacked_Js=function(_Base_Dashboard_Chart11){function _class13(){return classCallCheck(this,_class13),possibleConstructorReturn(this,(_class13.__proto__||Object.getPrototypeOf(_class13)).apply(this,arguments))}return inherits(_class13,_Base_Dashboard_Chart11),createClass(_class13,[{key:'getSubType',value:function getSubType(){return 'linePlainStacked'}}]),_class13}(Base_Dashboard_ChartFilter_Line_Js);
//# sourceMappingURL=Widgets.min.js.map
