{"version":3,"file":"Header.min.js","sources":["Header.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n\njQuery.Class(\n\t'Base_Header_Js',\n\t{\n\t\tquickCreateModuleCache: {},\n\t\tself: false,\n\t\tgetInstance: function () {\n\t\t\tif (this.self != false) {\n\t\t\t\treturn this.self;\n\t\t\t}\n\t\t\tthis.self = new Base_Header_Js();\n\t\t\treturn this.self;\n\t\t}\n\t},\n\t{\n\t\trecentPageViews: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tvar maxValues = 20;\n\t\t\tvar BtnText = '';\n\t\t\tvar BtnLink = 'javascript:void();';\n\t\t\tvar key = 'yf_history_portal_';\n\t\t\tvar history = localStorage.getItem(key);\n\t\t\tif (history != '' && history != null) {\n\t\t\t\tvar sp = history.toString().split('_|_');\n\t\t\t\tvar item = sp[sp.length - 1].toString().split('|');\n\t\t\t\tBtnText = item[0];\n\t\t\t\tBtnLink = item[1];\n\t\t\t}\n\t\t\tvar htmlContent = '<ul class=\"dropdown-menu float-right historyList px-3\" role=\"menu\">';\n\t\t\tvar date = new Date().getTime();\n\t\t\tvar howManyDays = -1;\n\t\t\tvar writeSelector = true;\n\t\t\tif (sp != null) {\n\t\t\t\tfor (var i = sp.length - 1; i >= 0; i--) {\n\t\t\t\t\titem = sp[i].toString().split('|');\n\t\t\t\t\tvar d = new Date();\n\t\t\t\t\tvar t = '';\n\t\t\t\t\tif (item[2] != undefined) {\n\t\t\t\t\t\td.setTime(item[2]);\n\t\t\t\t\t\tvar hours = app.formatDateZ(d.getHours());\n\t\t\t\t\t\tvar minutes = app.formatDateZ(d.getMinutes());\n\t\t\t\t\t\tif (writeSelector && howManyDays != app.howManyDaysFromDate(d)) {\n\t\t\t\t\t\t\thowManyDays = app.howManyDaysFromDate(d);\n\t\t\t\t\t\t\tif (howManyDays == 0) {\n\t\t\t\t\t\t\t\thtmlContent += '<li class=\"selectorHistory\">' + app.translate('JS_TODAY') + '</li>';\n\t\t\t\t\t\t\t} else if (howManyDays == 1) {\n\t\t\t\t\t\t\t\thtmlContent += '<li class=\"selectorHistory\">' + app.translate('JS_YESTERDAY') + '</li>';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\thtmlContent += '<li class=\"selectorHistory\">' + app.translate('JS_OLDER') + '</li>';\n\t\t\t\t\t\t\t\twriteSelector = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (writeSelector) t = '<span class=\"historyHour\">' + hours + ':' + minutes + '</span> | ';\n\t\t\t\t\t\telse t = app.formatDate(d) + ' | ';\n\t\t\t\t\t}\n\t\t\t\t\tvar format = $('#userDateFormat').val() + '' + $('#userDateFormat').val();\n\t\t\t\t\thtmlContent += '<li><a href=\"' + item[1] + '\">' + t + item[0] + '</a></li>';\n\t\t\t\t}\n\t\t\t\tvar Label = this.getHistoryLabel();\n\t\t\t\tif (Label.length > 1 && document.URL != BtnLink) {\n\t\t\t\t\tsp.push(this.getHistoryLabel() + '|' + document.URL + '|' + date);\n\t\t\t\t}\n\t\t\t\tif (sp.length >= maxValues) {\n\t\t\t\t\tsp.splice(0, 1);\n\t\t\t\t}\n\t\t\t\tlocalStorage.setItem(key, sp.join('_|_'));\n\t\t\t} else {\n\t\t\t\tvar stack = new Array();\n\t\t\t\tvar Label = this.getHistoryLabel();\n\t\t\t\tif (Label.length > 1) {\n\t\t\t\t\tstack.push(this.getHistoryLabel() + '|' + document.URL + '|' + date);\n\t\t\t\t\tlocalStorage.setItem(key, stack.join('_|_'));\n\t\t\t\t}\n\t\t\t}\n\t\t\thtmlContent +=\n\t\t\t\t'<li class=\"divider\"></li><li class=\"text-center\"><a class=\"clearHistory\" href=\"#\">' +\n\t\t\t\tapp.translate('JS_CLEAR_HISTORY') +\n\t\t\t\t'</a></li>';\n\t\t\thtmlContent += '</ul>';\n\t\t\t$('.showHistoryBtn').after(htmlContent);\n\t\t\tthis.registerClearHistory();\n\t\t},\n\t\tgetHistoryLabel: function () {\n\t\t\tvar label = '';\n\t\t\t$('.breadcrumbsLinks span').each(function (index) {\n\t\t\t\tlabel += $(this).text();\n\t\t\t});\n\t\t\treturn label;\n\t\t},\n\t\tregisterClearHistory: function () {\n\t\t\t$('.historyBtn .clearHistory').click(function () {\n\t\t\t\tvar key = 'yf_history_portal_';\n\t\t\t\tlocalStorage.removeItem(key);\n\t\t\t\tvar htmlContent =\n\t\t\t\t\t'<li class=\"divider\"></li><li class=\"text-center\"><a class=\"clearHistory\" href=\"#\">' +\n\t\t\t\t\tapp.translate('JS_CLEAR_HISTORY') +\n\t\t\t\t\t'</a></li>';\n\t\t\t\t$('.historyBtn .dropdown-menu').html(htmlContent);\n\t\t\t});\n\t\t},\n\t\tregisterChangeCompany: function () {\n\t\t\t$('#modalSelectCompanies').on('show.bs.modal', function (relatedTarget) {\n\t\t\t\tlet modal = $(relatedTarget.target);\n\t\t\t\tlet select = modal.find('select').addClass('select2');\n\t\t\t\tApp.Fields.Picklist.showSelect2ElementView(select);\n\t\t\t\tmodal.on('click', '.js-change-company', function (e) {\n\t\t\t\t\tAppConnector.request({\n\t\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\t\taction: 'ChangeCompany',\n\t\t\t\t\t\trecord: modal.find('#companyId').val()\n\t\t\t\t\t}).then(\n\t\t\t\t\t\tfunction (data) {\n\t\t\t\t\t\t\twindow.location.href = 'index.php';\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfunction (e, err) {\n\t\t\t\t\t\t\tconsole.log([e, err]);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\te.preventDefault();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tregisterEvents: function () {\n\t\t\tvar thisInstance = this;\n\t\t\tthisInstance.recentPageViews();\n\t\t\tthisInstance.registerChangeCompany();\n\t\t\tApp.Fields.Tree.getInstance();\n\t\t}\n\t}\n);\njQuery(document).ready(function () {\n\tBase_Header_Js.getInstance().registerEvents();\n});\n"],"names":["jQuery","Class","quickCreateModuleCache","self","getInstance","recentPageViews","thisInstance","BtnText","BtnLink","history","localStorage","getItem","toString","split","item","sp","length","date","getTime","howManyDays","writeSelector","i","t","d","setTime","app","formatDateZ","getHours","minutes","getMinutes","howManyDaysFromDate","htmlContent","translate","hours","formatDate","$","val","getHistoryLabel","document","URL","push","splice","setItem","join","Label","stack","after","registerClearHistory","each","label","text","click","removeItem","html","registerChangeCompany","on","relatedTarget","target","select","modal","find","addClass","App","Fields","Picklist","showSelect2ElementView","e","AppConnector","request","module","getModuleName","action","record","then","window","location","href","err","console","log","preventDefault","registerEvents","Tree","ready","Base_Header_Js"],"mappings":"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"}