{"version":3,"file":"RelatedListView.min.js","sources":["RelatedListView.js"],"sourcesContent":["/**\n * Base related list view class\n *\n * @copyright YetiForce S.A.\n * @license YetiForce Public License 5.0 (licenses/LicenseEN.txt or yetiforce.com)\n * @author Mariusz Krzaczkowski <m.krzaczkowski@yetiforce.com>\n */\n'use strict';\n\nwindow.Base_RelatedListView_Js = class {\n\t/**\n\t * Register data table\n\t */\n\tregisterDataTable() {\n\t\tthis.dataTable = app.registerDataTables(this.table, {\n\t\t\torder: [],\n\t\t\tprocessing: true,\n\t\t\tserverSide: true,\n\t\t\tsearching: false,\n\t\t\torderCellsTop: true,\n\t\t\tdeferRender: true,\n\t\t\tajax: {\n\t\t\t\turl: 'index.php',\n\t\t\t\ttype: 'POST',\n\t\t\t\tdata: (data) => {\n\t\t\t\t\t$.extend(data, this.container.serializeFormData());\n\t\t\t\t},\n\t\t\t\terror: function (jqXHR, ajaxOptions, thrownError) {\n\t\t\t\t\tapp.errorLog(jqXHR, thrownError);\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: thrownError,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tstack: window.stackPage\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.container.find('input').on('change', () => {\n\t\t\tthis.dataTable.ajax.reload();\n\t\t});\n\t}\n\t/**\n\t * Register record events\n\t */\n\tregisterRecordEvents() {\n\t\tthis.table.on('click', '.js-search-records', () => {\n\t\t\tthis.dataTable.ajax.reload();\n\t\t});\n\t\tthis.table.on('click', '.js-clear-search', () => {\n\t\t\tthis.table.find('.js-filter-field').each(function () {\n\t\t\t\tthis.value = '';\n\t\t\t});\n\t\t\tthis.dataTable.ajax.reload();\n\t\t});\n\t\tthis.container.on('click', '.js-create-related-record', (e) => {\n\t\t\tlet url = $(e.currentTarget).data('url');\n\t\t\tconst progress = $.progressIndicator({ blockInfo: { enabled: true } });\n\t\t\tlet params = {\n\t\t\t\tcallbackAfterSave: (response) => {\n\t\t\t\t\tthis.dataTable.ajax.reload();\n\t\t\t\t}\n\t\t\t};\n\t\t\tApp.Components.QuickCreate.getForm(url, params)\n\t\t\t\t.done((data) => {\n\t\t\t\t\tApp.Components.QuickCreate.showModal(data, params);\n\t\t\t\t})\n\t\t\t\t.fail((textStatus, errorThrown, jqXHR) => {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\ttitle: app.translate('JS_ERROR'),\n\t\t\t\t\t\ttext: jqXHR.responseJSON.error.message,\n\t\t\t\t\t\tanimation: 'show'\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.always(() => {\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t});\n\t}\n\t/**\n\t * Register modal events.\n\t */\n\tregisterEvents(container) {\n\t\tthis.container = container;\n\t\tthis.table = this.container.find('.js-list-view-table');\n\t\tthis.registerDataTable();\n\t\tthis.registerRecordEvents();\n\t}\n};\n"],"names":["window","Base_RelatedListView_Js","dataTable","app","registerDataTables","table","order","processing","serverSide","searching","orderCellsTop","deferRender","ajax","url","type","data","$","extend","container","serializeFormData","error","jqXHR","ajaxOptions","thrownError","errorLog","showNotify","text","stack","stackPage","find","on","reload","each","value","e","currentTarget","progress","progressIndicator","blockInfo","enabled","params","callbackAfterSave","App","Components","QuickCreate","getForm","done","showModal","fail","textStatus","errorThrown","title","translate","responseJSON","message","animation","always","mode","registerDataTable","registerRecordEvents"],"mappings":"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"}