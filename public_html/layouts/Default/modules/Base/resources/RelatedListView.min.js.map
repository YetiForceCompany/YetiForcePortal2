{"version":3,"file":"RelatedListView.min.js","sources":["RelatedListView.js"],"sourcesContent":["/**\n * Base related list view class\n *\n * @copyright YetiForce Sp. z o.o.\n * @license YetiForce Public License 4.0 (licenses/LicenseEN.txt or yetiforce.com)\n * @author Mariusz Krzaczkowski <m.krzaczkowski@yetiforce.com>\n */\n'use strict';\n\nwindow.Base_RelatedListView_Js = class {\n\t/**\n\t * Register data table\n\t */\n\tregisterDataTable() {\n\t\tthis.dataTable = app.registerDataTables(this.table, {\n\t\t\torder: [],\n\t\t\tprocessing: true,\n\t\t\tserverSide: true,\n\t\t\tsearching: false,\n\t\t\torderCellsTop: true,\n\t\t\tdeferRender: true,\n\t\t\tajax: {\n\t\t\t\turl: 'index.php',\n\t\t\t\ttype: 'POST',\n\t\t\t\tdata: (data) => {\n\t\t\t\t\t$.extend(data, this.container.serializeFormData());\n\t\t\t\t},\n\t\t\t\terror: function (jqXHR, ajaxOptions, thrownError) {\n\t\t\t\t\tapp.errorLog(jqXHR, thrownError);\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: thrownError,\n\t\t\t\t\t\ttype: 'error',\n\t\t\t\t\t\tstack: window.stackPage\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.container.find('input').on('change', () => {\n\t\t\tthis.dataTable.ajax.reload();\n\t\t});\n\t}\n\t/**\n\t * Register record events\n\t */\n\tregisterRecordEvents() {\n\t\tthis.table.on('click', '.js-search-records', () => {\n\t\t\tthis.dataTable.ajax.reload();\n\t\t});\n\t\tthis.table.on('click', '.js-clear-search', () => {\n\t\t\tthis.table.find('.js-filter-field').each(function () {\n\t\t\t\tthis.value = '';\n\t\t\t});\n\t\t\tthis.dataTable.ajax.reload();\n\t\t});\n\t\tthis.container.on('click', '.js-create-related-record', (e) => {\n\t\t\tlet url = $(e.currentTarget).data('url');\n\t\t\tconst progress = $.progressIndicator({ blockInfo: { enabled: true } });\n\t\t\tlet params = {\n\t\t\t\tcallbackAfterSave: (response) => {\n\t\t\t\t\tthis.dataTable.ajax.reload();\n\t\t\t\t}\n\t\t\t};\n\t\t\tApp.Components.QuickCreate.getForm(url, params)\n\t\t\t\t.done((data) => {\n\t\t\t\t\tApp.Components.QuickCreate.showModal(data, params);\n\t\t\t\t})\n\t\t\t\t.fail((textStatus, errorThrown) => {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: errorThrown,\n\t\t\t\t\t\ttitle: app.translate('JS_ERROR'),\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.always(() => {\n\t\t\t\t\tprogress.progressIndicator({ mode: 'hide' });\n\t\t\t\t});\n\t\t});\n\t}\n\t/**\n\t * Register modal events.\n\t */\n\tregisterEvents(container) {\n\t\tthis.container = container;\n\t\tthis.table = this.container.find('.js-list-view-table');\n\t\tthis.registerDataTable();\n\t\tthis.registerRecordEvents();\n\t}\n};\n"],"names":["window","Base_RelatedListView_Js","dataTable","app","registerDataTables","table","order","processing","serverSide","searching","orderCellsTop","deferRender","ajax","url","type","data","$","extend","container","serializeFormData","error","jqXHR","ajaxOptions","thrownError","errorLog","showNotify","text","stack","stackPage","find","on","reload","each","value","e","currentTarget","progress","progressIndicator","blockInfo","enabled","params","callbackAfterSave","App","Components","QuickCreate","getForm","done","showModal","fail","textStatus","errorThrown","title","translate","always","mode","registerDataTable","registerRecordEvents"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AASAA,OAAOC,uBAAP;;IAAA,kCAIqB,gBACnB,KAAKC,SAAL,CAAiBC,IAAIC,kBAAJ,CAAuB,KAAKC,KAA5B,CAAmC,CACnDC,MAAO,EAD4C,CAEnDC,aAFmD,CAGnDC,aAHmD,CAInDC,YAJmD,CAKnDC,gBALmD,CAMnDC,cANmD,CAOnDC,KAAM,CACLC,IAAK,WADA,CAELC,KAAM,MAFD,CAGLC,KAAM,cAACA,KAAD,CAAU,CACfC,EAAEC,MAAF,CAASF,KAAT,CAAe,MAAKG,SAAL,CAAeC,iBAAf,EAAf,EACA,CALI,CAMLC,MAAO,eAAUC,KAAV,CAAiBC,WAAjB,CAA8BC,WAA9B,CAA2C,CACjDpB,IAAIqB,QAAJ,CAAaH,KAAb,CAAoBE,WAApB,CADiD,CAEjDpB,IAAIsB,UAAJ,CAAe,CACdC,KAAMH,WADQ,CAEdT,KAAM,OAFQ,CAGda,MAAO3B,OAAO4B,SAHA,CAAf,EAKA,CAbI,CAP6C,CAAnC,CADE,CAwBnB,KAAKV,SAAL,CAAeW,IAAf,CAAoB,OAApB,EAA6BC,EAA7B,CAAgC,QAAhC,CAA0C,UAAM,CAC/C,MAAK5B,SAAL,CAAeU,IAAf,CAAoBmB,MAApB,GACA,CAFD,EAGA,CACD;;uEAGuB,iBACtB,KAAK1B,KAAL,CAAWyB,EAAX,CAAc,OAAd,CAAuB,oBAAvB,CAA6C,UAAM,CAClD,OAAK5B,SAAL,CAAeU,IAAf,CAAoBmB,MAApB,GACA,CAFD,CADsB,CAItB,KAAK1B,KAAL,CAAWyB,EAAX,CAAc,OAAd,CAAuB,kBAAvB,CAA2C,UAAM,CAChD,OAAKzB,KAAL,CAAWwB,IAAX,CAAgB,kBAAhB,EAAoCG,IAApC,CAAyC,UAAY,CACpD,KAAKC,KAAL,CAAa,GACb,CAFD,CADgD,CAIhD,OAAK/B,SAAL,CAAeU,IAAf,CAAoBmB,MAApB,GACA,CALD,CAJsB,CAUtB,KAAKb,SAAL,CAAeY,EAAf,CAAkB,OAAlB,CAA2B,2BAA3B,CAAwD,SAACI,CAAD,CAAO,SACpDlB,EAAEkB,EAAEC,aAAJ,EAAmBpB,IAAnB,CAAwB,KAAxB,CADoD,CAExDqB,SAAWpB,EAAEqB,iBAAF,CAAoB,CAAEC,UAAW,CAAEC,UAAF,CAAb,CAApB,CAF6C,CAG1DC,OAAS,CACZC,kBAAmB,4BAAc,CAChC,OAAKvC,SAAL,CAAeU,IAAf,CAAoBmB,MAApB,GACA,CAHW,CAHiD,CAQ9DW,IAAIC,UAAJ,CAAeC,WAAf,CAA2BC,OAA3B,CAAmChC,GAAnC,CAAwC2B,MAAxC,EACEM,IADF,CACO,SAAC/B,IAAD,CAAU,CACf2B,IAAIC,UAAJ,CAAeC,WAAf,CAA2BG,SAA3B,CAAqChC,IAArC,CAA2CyB,MAA3C,EACA,CAHF,EAIEQ,IAJF,CAIO,SAACC,UAAD,CAAaC,WAAb,CAA6B,CAClC/C,IAAIsB,UAAJ,CAAe,CACdC,KAAMwB,WADQ,CAEdC,MAAOhD,IAAIiD,SAAJ,CAAc,UAAd,CAFO,CAGdtC,KAAM,OAHQ,CAAf,EAKA,CAVF,EAWEuC,MAXF,CAWS,UAAM,CACbjB,SAASC,iBAAT,CAA2B,CAAEiB,KAAM,MAAR,CAA3B,EACA,CAbF,EAcA,CAtBD,EAuBA,CACD;;0DAGepC,SAxEhB,CAwE2B,CACzB,KAAKA,SAAL,CAAiBA,SADQ,CAEzB,KAAKb,KAAL,CAAa,KAAKa,SAAL,CAAeW,IAAf,CAAoB,qBAApB,CAFY,CAGzB,KAAK0B,iBAAL,EAHyB,CAIzB,KAAKC,oBAAL,GACA,CA7EF"}