'use strict';

jQuery.Class('Base_Header_Js',{self:!1,getInstance:function getInstance(){return !1==this.self?(this.self=new Base_Header_Js,this.self):this.self}},{recentPageViews:function recentPageViews(){var BtnText='',BtnLink='javascript:void();',history=localStorage.getItem('yf_history_portal_');if(''!=history&&null!=history){var sp=history.toString().split('_|_'),item=sp[sp.length-1].toString().split('|');BtnText=item[0],BtnLink=item[1];}var htmlContent='<ul class="dropdown-menu float-right historyList px-3" role="menu">',date=new Date().getTime(),howManyDays=-1,writeSelector=!0;if(null!=sp){for(var i=sp.length-1;0<=i;i--){item=sp[i].toString().split('|');var d=new Date,t='';if(item[2]!=null){d.setTime(item[2]);var hours=app.formatDateZ(d.getHours()),minutes=app.formatDateZ(d.getMinutes());writeSelector&&howManyDays!=app.howManyDaysFromDate(d)&&(howManyDays=app.howManyDaysFromDate(d),0==howManyDays?htmlContent+='<li class="selectorHistory">'+app.translate('JS_TODAY')+'</li>':1==howManyDays?htmlContent+='<li class="selectorHistory">'+app.translate('JS_YESTERDAY')+'</li>':(htmlContent+='<li class="selectorHistory">'+app.translate('JS_OLDER')+'</li>',writeSelector=!1)),t=writeSelector?'<span class="historyHour">'+hours+':'+minutes+'</span> | ':app.formatDate(d)+' | ';}$('#userDateFormat').val()+''+$('#userDateFormat').val();htmlContent+=' <a class="item dropdown-item" href="'+item[1]+'">'+t+item[0]+'</a>';}var Label=this.getHistoryLabel();1<Label.length&&document.URL!=BtnLink&&sp.push(this.getHistoryLabel()+'|'+document.URL+'|'+date),sp.length>=20&&sp.splice(0,1),localStorage.setItem('yf_history_portal_',sp.join('_|_'));}else {var stack=new Array,Label=this.getHistoryLabel();1<Label.length&&(stack.push(this.getHistoryLabel()+'|'+document.URL+'|'+date),localStorage.setItem('yf_history_portal_',stack.join('_|_')));}htmlContent+=null==history?' <a class="item dropdown-item" href="#" role="listitem">'+app.translate('JS_NO_RECORDS')+'</a>':'<div class="dropdown-divider"></div><a class="dropdown-item clearHistory" href="#">'+app.translate('JS_CLEAR_HISTORY')+'</a>',htmlContent+='</ul>',$('.showHistoryBtn').after(htmlContent),this.registerClearHistory();},getHistoryLabel:function getHistoryLabel(){var label='';return $('.breadcrumbsLinks span').each(function(){label+=$(this).text().replace(/\//g,' ');}),label},registerClearHistory:function registerClearHistory(){$('.historyBtn .clearHistory').click(function(){localStorage.removeItem('yf_history_portal_');var htmlContent='<a class="item dropdown-item" href="#" role="listitem">'+app.translate('JS_NO_RECORDS')+'</a>';$('.historyBtn .dropdown-menu').html(htmlContent);});},registerChangeCompany:function registerChangeCompany(){$('#modalSelectCompanies').on('show.bs.modal',function(relatedTarget){var modal=$(relatedTarget.target),select=modal.find('select').addClass('select2');App.Fields.Picklist.showSelect2ElementView(select),modal.on('click','.js-change-company',function(e){AppConnector.request({module:app.getModuleName(),action:'ChangeCompany',record:modal.find('#companyId').val()}).done(function(){window.location.href='index.php';}),e.preventDefault();});});},/**
		 * Show left scrollbar for menu.
		 */registerScrolbarToMenu:function registerScrolbarToMenu(){var container=$('.js-base-container'),menuContainer=container.find('.js-menu--scroll');app.showNewScrollbarLeft(menuContainer,{suppressScrollX:!0});},/**
		 * Pin menu
		 */registerPinEvent:function registerPinEvent(){var container=$('.js-base-container'),pinButton=container.find('.js-menu--pin');pinButton.on('click',function(){var hideMenu=0;'0'===pinButton.attr('data-show')?(hideMenu=1,pinButton.removeClass('u-opacity-muted'),container.addClass('c-menu--open')):(pinButton.addClass('u-opacity-muted'),container.removeClass('c-menu--open')),pinButton.attr('data-show',hideMenu),AppConnector.request({module:'Users',action:'UserPreferences',key:'menuPin',value:hideMenu}).done(function(response){response.success&&app.showNotify({text:app.translate('JS_SAVE_NOTIFY_SUCCESS'),type:'success'});}),setTimeout(function(){container.addClass('c-menu--animation');},300);});},registerEvents:function registerEvents(){var thisInstance=this;thisInstance.recentPageViews(),thisInstance.registerChangeCompany(),thisInstance.registerScrolbarToMenu(),thisInstance.registerPinEvent(),App.Fields.Tree.getInstance();}}),jQuery(document).ready(function(){Base_Header_Js.getInstance().registerEvents();});
//# sourceMappingURL=Header.min.js.map
