'use strict';

/* {[The file is published on the basis of YetiForce Public License 3.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */jQuery.Class('Base_Header_Js',{quickCreateModuleCache:{},self:!1,getInstance:function getInstance(){return !1==this.self?(this.self=new Base_Header_Js,this.self):this.self}},{recentPageViews:function recentPageViews(){var BtnText='',BtnLink='javascript:void();',history=localStorage.getItem('yf_history_portal_');if(''!=history&&null!=history){var sp=history.toString().split('_|_'),item=sp[sp.length-1].toString().split('|');BtnText=item[0],BtnLink=item[1];}var htmlContent='<ul class="dropdown-menu float-right historyList px-3" role="menu">',date=new Date().getTime(),howManyDays=-1,writeSelector=!0;if(null!=sp){for(var i=sp.length-1;0<=i;i--){item=sp[i].toString().split('|');var d=new Date,t='';if(item[2]!=null){d.setTime(item[2]);var hours=app.formatDateZ(d.getHours()),minutes=app.formatDateZ(d.getMinutes());writeSelector&&howManyDays!=app.howManyDaysFromDate(d)&&(howManyDays=app.howManyDaysFromDate(d),0==howManyDays?htmlContent+='<li class="selectorHistory">'+app.translate('JS_TODAY')+'</li>':1==howManyDays?htmlContent+='<li class="selectorHistory">'+app.translate('JS_YESTERDAY')+'</li>':(htmlContent+='<li class="selectorHistory">'+app.translate('JS_OLDER')+'</li>',writeSelector=!1)),t=writeSelector?'<span class="historyHour">'+hours+':'+minutes+'</span> | ':app.formatDate(d)+' | ';}$('#userDateFormat').val()+''+$('#userDateFormat').val();htmlContent+='<li><a href="'+item[1]+'">'+t+item[0]+'</a></li>';}var Label=this.getHistoryLabel();1<Label.length&&document.URL!=BtnLink&&sp.push(this.getHistoryLabel()+'|'+document.URL+'|'+date),sp.length>=20&&sp.splice(0,1),localStorage.setItem('yf_history_portal_',sp.join('_|_'));}else {var stack=new Array,Label=this.getHistoryLabel();1<Label.length&&(stack.push(this.getHistoryLabel()+'|'+document.URL+'|'+date),localStorage.setItem('yf_history_portal_',stack.join('_|_')));}htmlContent+='<li class="divider"></li><li class="text-center"><a class="clearHistory" href="#">'+app.translate('JS_CLEAR_HISTORY')+'</a></li>',htmlContent+='</ul>',$('.showHistoryBtn').after(htmlContent),this.registerClearHistory();},getHistoryLabel:function getHistoryLabel(){var label='';return $('.breadcrumbsLinks span').each(function(){label+=$(this).text();}),label},registerClearHistory:function registerClearHistory(){$('.historyBtn .clearHistory').click(function(){localStorage.removeItem('yf_history_portal_');var htmlContent='<li class="divider"></li><li class="text-center"><a class="clearHistory" href="#">'+app.translate('JS_CLEAR_HISTORY')+'</a></li>';$('.historyBtn .dropdown-menu').html(htmlContent);});},registerChangeCompany:function registerChangeCompany(){$('#modalSelectCompanies').on('show.bs.modal',function(relatedTarget){var modal=$(relatedTarget.target),select=modal.find('select').addClass('select2');App.Fields.Picklist.showSelect2ElementView(select),modal.on('click','.js-change-company',function(e){AppConnector.request({module:app.getModuleName(),action:'ChangeCompany',record:modal.find('#companyId').val()}).then(function(){window.location.href='index.php';},function(e,err){console.log([e,err]);}),e.preventDefault();});});},registerEvents:function registerEvents(){var thisInstance=this;thisInstance.recentPageViews(),thisInstance.registerChangeCompany(),App.Fields.Tree.getInstance();}}),jQuery(document).ready(function(){Base_Header_Js.getInstance().registerEvents();});
//# sourceMappingURL=Header.min.js.map
