{"version":3,"file":"ProceedToCheckout.min.js","sources":["ProceedToCheckout.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\nwindow.Products_ProceedToCheckout_Js = class extends Products_Tree_Js {\n\tconstructor(container = $('.js-products-container')) {\n\t\tsuper(container);\n\t\tthis.container = container;\n\t}\n\tregisterEvents() {\n\t\tsuper.registerEvents();\n\t\tthis.registerButtonBuy();\n\t}\n\tregisterButtonBuy() {\n\t\tlet self = this;\n\t\tthis.container.find('.js-buy').on('click', (e) => {\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.translate('LBL_VERIFY_ADDRESS'),\n\t\t\t\ticon: 'fas fa-address-card',\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tself.order({\n\t\t\t\t\t\treference_id: self.container.data('referenceId'),\n\t\t\t\t\t\treference_module: self.container.data('referenceModule')\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\torder(params = {}) {\n\t\tconst progressInstance = $.progressIndicatorShow();\n\t\tAppConnector.request(\n\t\t\t$.extend(\n\t\t\t\t{\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'Buy'\n\t\t\t\t},\n\t\t\t\tparams\n\t\t\t)\n\t\t).done((data) => {\n\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\tlet result = data['result'];\n\t\t\tif (typeof result['errors'] === 'undefined') {\n\t\t\t\tif (typeof result['paymentUrl'] === 'undefined') {\n\t\t\t\t\tapp.openUrl('index.php?module=SSingleOrders&view=DetailView&record=' + result['id']);\n\t\t\t\t} else if (typeof result['paymentPostData'] === 'undefined') {\n\t\t\t\t\tapp.openUrl(result['paymentUrl']);\n\t\t\t\t} else {\n\t\t\t\t\tapp.openUrlMethodPost(result['paymentUrl'], result['paymentPostData']);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.container.find('.js-cart-item .js-no-such-quantity').toggleClass('d-none', true);\n\t\t\t\t$.each(result['errors']['inventory'], (index, value) => {\n\t\t\t\t\tlet quantity = value['params']['quantity'];\n\t\t\t\t\tlet product = this.container.find('.js-cart-item[data-id=\"' + index + '\"]');\n\t\t\t\t\tproduct.find('.js-no-such-quantity').removeClass('d-none');\n\t\t\t\t\tproduct.find('.js-maximum-quantity').text(quantity);\n\t\t\t\t});\n\t\t\t\tif (result['errors']['limit']) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: result['errors']['limit'],\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\n"],"names":["window","Products_ProceedToCheckout_Js","container","$","registerButtonBuy","self","find","on","app","showConfirmModal","title","translate","icon","confirmedCallback","order","reference_id","data","reference_module","params","progressInstance","progressIndicatorShow","AppConnector","request","extend","module","getModuleName","action","done","progressIndicator","mode","result","openUrl","openUrlMethodPost","toggleClass","each","index","value","quantity","product","removeClass","text","showNotify","type","Products_Tree_Js"],"mappings":";;AAAA,kKACA,mjGACAA,MAAM,CAACC,6BAAP,0CACC,iBAAqD,WAAzCC,SAAyC,wDAA7BC,CAAC,CAAC,wBAAD,CAA4B,4DAC9CD,SAD8C,EAEpD,MAAKA,SAAL,CAAiBA,SAFmC,MAGpD,CAJF,4HAKC,yBAAiB,0EAEhB,KAAKE,iBAAL,GACA,CARF,iCASC,4BAAoB,CACnB,IAAIC,IAAI,CAAG,IAAX,CACA,KAAKH,SAAL,CAAeI,IAAf,CAAoB,SAApB,EAA+BC,EAA/B,CAAkC,OAAlC,CAA2C,UAAO,CACjDC,GAAG,CAACC,gBAAJ,CAAqB,CACpBC,KAAK,CAAEF,GAAG,CAACG,SAAJ,CAAc,oBAAd,CADa,CAEpBC,IAAI,CAAE,qBAFc,CAGpBC,iBAAiB,CAAE,4BAAM,CACxBR,IAAI,CAACS,KAAL,CAAW,CACVC,YAAY,CAAEV,IAAI,CAACH,SAAL,CAAec,IAAf,CAAoB,aAApB,CADJ,CAEVC,gBAAgB,CAAEZ,IAAI,CAACH,SAAL,CAAec,IAAf,CAAoB,iBAApB,CAFR,CAAX,EAIA,CARmB,CAArB,EAUA,CAXD,EAYA,CAvBF,qBAwBC,gBAAmB,iBAAbE,MAAa,wDAAJ,EAAI,CACZC,gBAAgB,CAAGhB,CAAC,CAACiB,qBAAF,EADP,CAElBC,YAAY,CAACC,OAAb,CACCnB,CAAC,CAACoB,MAAF,CACC,CACCC,MAAM,CAAEhB,GAAG,CAACiB,aAAJ,EADT,CAECC,MAAM,CAAE,KAFT,CADD,CAKCR,MALD,CADD,EAQES,IARF,CAQO,SAACX,IAAD,CAAU,CAChBG,gBAAgB,CAACS,iBAAjB,CAAmC,CAAEC,IAAI,CAAE,MAAR,CAAnC,CADgB,CAEhB,IAAIC,MAAM,CAAGd,IAAI,OAAjB,CACgC,WAA5B,SAAOc,MAAM,OAHD,CAIqB,WAAhC,SAAOA,MAAM,WAJF,CAKdtB,GAAG,CAACuB,OAAJ,CAAY,yDAA2DD,MAAM,GAA7E,CALc,CAMiC,WAArC,SAAOA,MAAM,gBANT,CAOdtB,GAAG,CAACuB,OAAJ,CAAYD,MAAM,WAAlB,CAPc,CASdtB,GAAG,CAACwB,iBAAJ,CAAsBF,MAAM,WAA5B,CAA4CA,MAAM,gBAAlD,CATc,EAYf,MAAI,CAAC5B,SAAL,CAAeI,IAAf,CAAoB,oCAApB,EAA0D2B,WAA1D,CAAsE,QAAtE,IAZe,CAaf9B,CAAC,CAAC+B,IAAF,CAAOJ,MAAM,OAAN,UAAP,CAAsC,SAACK,KAAD,CAAQC,KAAR,CAAkB,KACnDC,QAAQ,CAAGD,KAAK,OAAL,SADwC,CAEnDE,OAAO,CAAG,MAAI,CAACpC,SAAL,CAAeI,IAAf,CAAoB,2BAA4B6B,KAA5B,CAAoC,KAAxD,CAFyC,CAGvDG,OAAO,CAAChC,IAAR,CAAa,sBAAb,EAAqCiC,WAArC,CAAiD,QAAjD,CAHuD,CAIvDD,OAAO,CAAChC,IAAR,CAAa,sBAAb,EAAqCkC,IAArC,CAA0CH,QAA1C,EACA,CALD,CAbe,CAmBXP,MAAM,OAAN,MAnBW,EAoBdtB,GAAG,CAACiC,UAAJ,CAAe,CACdD,IAAI,CAAEV,MAAM,OAAN,MADQ,CAEdY,IAAI,CAAE,OAFQ,CAAf,CApBc,EA0BhB,CAlCD,EAmCA,CA7DF,YAAqDC,gBAArD;;"}