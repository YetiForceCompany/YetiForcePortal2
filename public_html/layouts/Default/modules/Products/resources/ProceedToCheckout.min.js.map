{"version":3,"file":"ProceedToCheckout.min.js","sources":["ProceedToCheckout.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 5.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\nwindow.Products_ProceedToCheckout_Js = class extends Products_Tree_Js {\n\tconstructor(container = $('.js-products-container')) {\n\t\tsuper(container);\n\t\tthis.container = container;\n\t}\n\tregisterEvents() {\n\t\tsuper.registerEvents();\n\t\tthis.registerButtonBuy();\n\t}\n\tregisterButtonBuy() {\n\t\tlet self = this;\n\t\tthis.container.find('.js-buy').on('click', (e) => {\n\t\t\tapp.showConfirmModal({\n\t\t\t\ttitle: app.translate('LBL_VERIFY_ADDRESS'),\n\t\t\t\ticon: 'fas fa-address-card',\n\t\t\t\tconfirmedCallback: () => {\n\t\t\t\t\tself.order({\n\t\t\t\t\t\treference_id: self.container.data('referenceId'),\n\t\t\t\t\t\treference_module: self.container.data('referenceModule')\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\torder(params = {}) {\n\t\tconst progressInstance = $.progressIndicatorShow();\n\t\tAppConnector.request(\n\t\t\t$.extend(\n\t\t\t\t{\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'Buy'\n\t\t\t\t},\n\t\t\t\tparams\n\t\t\t)\n\t\t).done((data) => {\n\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\tlet result = data['result'];\n\t\t\tif (typeof result['errors'] === 'undefined') {\n\t\t\t\tif (typeof result['paymentUrl'] === 'undefined') {\n\t\t\t\t\tapp.openUrl('index.php?module=SSingleOrders&view=DetailView&record=' + result['id']);\n\t\t\t\t} else if (typeof result['paymentPostData'] === 'undefined') {\n\t\t\t\t\tapp.openUrl(result['paymentUrl']);\n\t\t\t\t} else {\n\t\t\t\t\tapp.openUrlMethodPost(result['paymentUrl'], result['paymentPostData']);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.container.find('.js-cart-item .js-no-such-quantity').toggleClass('d-none', true);\n\t\t\t\t$.each(result['errors']['inventory'], (index, value) => {\n\t\t\t\t\tlet quantity = value['params']['quantity'];\n\t\t\t\t\tlet product = this.container.find('.js-cart-item[data-id=\"' + index + '\"]');\n\t\t\t\t\tproduct.find('.js-no-such-quantity').removeClass('d-none');\n\t\t\t\t\tproduct.find('.js-maximum-quantity').text(quantity);\n\t\t\t\t});\n\t\t\t\tif (result['errors']['limit']) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: result['errors']['limit'],\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\n"],"names":["window","Products_ProceedToCheckout_Js","container","$","registerButtonBuy","find","on","app","showConfirmModal","title","translate","icon","confirmedCallback","self","order","reference_id","data","reference_module","params","progressInstance","progressIndicatorShow","AppConnector","request","extend","module","getModuleName","action","done","progressIndicator","mode","openUrl","result","openUrlMethodPost","toggleClass","each","index","value","product","removeClass","text","quantity","showNotify","type","Products_Tree_Js"],"mappings":"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"}