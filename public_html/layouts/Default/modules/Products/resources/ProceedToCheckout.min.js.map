{"version":3,"file":"ProceedToCheckout.min.js","sources":["ProceedToCheckout.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\nwindow.Products_ProceedToCheckout_Js = class extends Products_Tree_Js {\n\tconstructor(container = $('.js-products-container')) {\n\t\tsuper(container);\n\t\tthis.container = container;\n\t}\n\tregisterEvents() {\n\t\tsuper.registerEvents();\n\t\tthis.registerButtonBuy();\n\t}\n\tregisterButtonBuy() {\n\t\tlet self = this;\n\t\tthis.container.find('.js-buy').on('click', (e) => {\n\t\t\tBase_Helper_Js.showConfirmationBox({\n\t\t\t\tmessage: app.translate('LBL_VERIFY_ADDRESS')\n\t\t\t}).done(function (data) {\n\t\t\t\tself.order({\n\t\t\t\t\treference_id: self.container.data('referenceId'),\n\t\t\t\t\treference_module: self.container.data('referenceModule')\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\torder(params = {}) {\n\t\tconst progressInstance = $.progressIndicatorShow();\n\t\tAppConnector.request(\n\t\t\t$.extend(\n\t\t\t\t{\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'Buy'\n\t\t\t\t},\n\t\t\t\tparams\n\t\t\t)\n\t\t).done((data) => {\n\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\tlet result = data['result'];\n\t\t\tif (typeof result['errors'] === 'undefined') {\n\t\t\t\tif (typeof result['paymentUrl'] === 'undefined') {\n\t\t\t\t\tapp.openUrl('index.php?module=SSingleOrders&view=DetailView&record=' + result['id']);\n\t\t\t\t} else if (typeof result['paymentPostData'] === 'undefined') {\n\t\t\t\t\tapp.openUrl(result['paymentUrl']);\n\t\t\t\t} else {\n\t\t\t\t\tapp.openUrlMethodPost(result['paymentUrl'], result['paymentPostData']);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.container.find('.js-cart-item .js-no-such-quantity').toggleClass('d-none', true);\n\t\t\t\t$.each(result['errors']['inventory'], (index, value) => {\n\t\t\t\t\tlet quantity = value['params']['quantity'];\n\t\t\t\t\tlet product = this.container.find('.js-cart-item[data-id=\"' + index + '\"]');\n\t\t\t\t\tproduct.find('.js-no-such-quantity').removeClass('d-none');\n\t\t\t\t\tproduct.find('.js-maximum-quantity').text(quantity);\n\t\t\t\t});\n\t\t\t\tif (result['errors']['limit']) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: result['errors']['limit'],\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\n"],"names":["window","Products_ProceedToCheckout_Js","$","container","registerButtonBuy","find","on","Base_Helper_Js","showConfirmationBox","message","app","translate","done","self","order","reference_id","data","reference_module","params","progressInstance","progressIndicatorShow","AppConnector","request","extend","module","getModuleName","action","progressIndicator","mode","openUrl","result","openUrlMethodPost","toggleClass","each","index","value","product","removeClass","text","quantity","showNotify","type","Products_Tree_Js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEAA,OAAOC,6BAAP,6BACC,iBAAqD,cAAA,wDAA7BC,EAAE,wBAAF,CAA6B,kIAC9CC,SAD8C,gBAE/CA,SAAL,CAAiBA,SAFmC,MAGpD,CAJF,mHAKkB,2GAEhB,KAAKC,iBAAL,GACA,CARF,6DASqB,CACnB,SAAW,IAAX,CACA,KAAKD,SAAL,CAAeE,IAAf,CAAoB,SAApB,EAA+BC,EAA/B,CAAkC,OAAlC,CAA2C,UAAO,CACjDC,eAAeC,mBAAf,CAAmC,CAClCC,QAASC,IAAIC,SAAJ,CAAc,oBAAd,CADyB,CAAnC,EAEGC,IAFH,CAEQ,UAAgB,CACvBC,KAAKC,KAAL,CAAW,CACVC,aAAcF,KAAKV,SAAL,CAAea,IAAf,CAAoB,aAApB,CADJ,CAEVC,iBAAkBJ,KAAKV,SAAL,CAAea,IAAf,CAAoB,iBAApB,CAFR,CAAX,EAIA,CAPD,EAQA,CATD,EAUA,CArBF,qCAsBoB,iBAAbE,MAAa,wDAAJ,EAAI,CACZC,iBAAmBjB,EAAEkB,qBAAF,EADP,CAElBC,aAAaC,OAAb,CACCpB,EAAEqB,MAAF,CACC,CACCC,OAAQd,IAAIe,aAAJ,EADT,CAECC,OAAQ,KAFT,CADD,CAKCR,MALD,CADD,EAQEN,IARF,CAQO,SAACI,IAAD,CAAU,CAChBG,iBAAiBQ,iBAAjB,CAAmC,CAAEC,KAAM,MAAR,CAAnC,CADgB,CAEhB,WAAaZ,WAAb,CACgC,WAA5B,sBAHY,CAIqB,WAAhC,0BAJW,CAKdN,IAAImB,OAAJ,CAAY,yDAA2DC,SAAvE,CALc,CAMiC,WAArC,+BANI,CAOdpB,IAAImB,OAAJ,CAAYC,iBAAZ,CAPc,CASdpB,IAAIqB,iBAAJ,CAAsBD,iBAAtB,CAA4CA,sBAA5C,CATc,EAYf,OAAK3B,SAAL,CAAeE,IAAf,CAAoB,oCAApB,EAA0D2B,WAA1D,CAAsE,QAAtE,IAZe,CAaf9B,EAAE+B,IAAF,CAAOH,uBAAP,CAAsC,SAACI,KAAD,CAAQC,KAAR,CAAkB,cACxCA,qBADwC,CAEnDC,QAAU,OAAKjC,SAAL,CAAeE,IAAf,CAAoB,0BAA4B6B,KAA5B,CAAoC,IAAxD,CAFyC,CAGvDE,QAAQ/B,IAAR,CAAa,sBAAb,EAAqCgC,WAArC,CAAiD,QAAjD,CAHuD,CAIvDD,QAAQ/B,IAAR,CAAa,sBAAb,EAAqCiC,IAArC,CAA0CC,QAA1C,EACA,CALD,CAbe,CAmBXT,mBAnBW,EAoBdpB,IAAI8B,UAAJ,CAAe,CACdF,KAAMR,mBADQ,CAEdW,KAAM,OAFQ,CAAf,CApBc,EA0BhB,CAlCD,EAmCA,CA3DF,YAAqDC,gBAArD"}