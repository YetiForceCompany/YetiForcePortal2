{"version":3,"file":"ProceedToCheckout.min.js","sources":["ProceedToCheckout.js"],"sourcesContent":["/* {[The file is published on the basis of YetiForce Public License 4.0 that can be found in the following directory: licenses/LicenseEN.txt or yetiforce.com]} */\n'use strict';\nwindow.Products_ProceedToCheckout_Js = class extends Products_Tree_Js {\n\tconstructor(container = $('.js-products-container')) {\n\t\tsuper(container);\n\t\tthis.container = container;\n\t}\n\tregisterEvents() {\n\t\tsuper.registerEvents();\n\t\tthis.registerButtonBuy();\n\t}\n\tregisterButtonBuy() {\n\t\tlet self = this;\n\t\tthis.container.find('.js-buy').on('click', (e) => {\n\t\t\tBase_Helper_Js.showConfirmationBox({\n\t\t\t\tmessage: app.translate('LBL_VERIFY_ADDRESS')\n\t\t\t}).done(function (data) {\n\t\t\t\tself.order({\n\t\t\t\t\treference_id: self.container.data('referenceId'),\n\t\t\t\t\treference_module: self.container.data('referenceModule')\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\torder(params = {}) {\n\t\tconst progressInstance = $.progressIndicatorShow();\n\t\tAppConnector.request(\n\t\t\t$.extend(\n\t\t\t\t{\n\t\t\t\t\tmodule: app.getModuleName(),\n\t\t\t\t\taction: 'Buy'\n\t\t\t\t},\n\t\t\t\tparams\n\t\t\t)\n\t\t).done((data) => {\n\t\t\tprogressInstance.progressIndicator({ mode: 'hide' });\n\t\t\tlet result = data['result'];\n\t\t\tif (typeof result['errors'] === 'undefined') {\n\t\t\t\tif (typeof result['paymentUrl'] === 'undefined') {\n\t\t\t\t\tapp.openUrl('index.php?module=SSingleOrders&view=DetailView&record=' + result['id']);\n\t\t\t\t} else if (typeof result['paymentPostData'] === 'undefined') {\n\t\t\t\t\tapp.openUrl(result['paymentUrl']);\n\t\t\t\t} else {\n\t\t\t\t\tapp.openUrlMethodPost(result['paymentUrl'], result['paymentPostData']);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.container.find('.js-cart-item .js-no-such-quantity').toggleClass('d-none', true);\n\t\t\t\t$.each(result['errors']['inventory'], (index, value) => {\n\t\t\t\t\tlet quantity = value['params']['quantity'];\n\t\t\t\t\tlet product = this.container.find('.js-cart-item[data-id=\"' + index + '\"]');\n\t\t\t\t\tproduct.find('.js-no-such-quantity').removeClass('d-none');\n\t\t\t\t\tproduct.find('.js-maximum-quantity').text(quantity);\n\t\t\t\t});\n\t\t\t\tif (result['errors']['limit']) {\n\t\t\t\t\tapp.showNotify({\n\t\t\t\t\t\ttext: result['errors']['limit'],\n\t\t\t\t\t\ttype: 'error'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n};\n"],"names":["window","Products_ProceedToCheckout_Js","container","$","registerButtonBuy","self","find","on","Base_Helper_Js","showConfirmationBox","message","app","translate","done","order","reference_id","data","reference_module","params","progressInstance","progressIndicatorShow","AppConnector","request","extend","module","getModuleName","action","progressIndicator","mode","result","openUrl","openUrlMethodPost","toggleClass","each","index","value","quantity","product","removeClass","text","showNotify","type","Products_Tree_Js"],"mappings":";;AAAA,kKACA,mjGACAA,MAAM,CAACC,6BAAP,0CACC,iBAAqD,WAAzCC,SAAyC,wDAA7BC,CAAC,CAAC,wBAAD,CAA4B,4DAC9CD,SAD8C,EAEpD,MAAKA,SAAL,CAAiBA,SAFmC,MAGpD,CAJF,4HAKC,yBAAiB,0EAEhB,KAAKE,iBAAL,GACA,CARF,iCASC,4BAAoB,CACnB,IAAIC,IAAI,CAAG,IAAX,CACA,KAAKH,SAAL,CAAeI,IAAf,CAAoB,SAApB,EAA+BC,EAA/B,CAAkC,OAAlC,CAA2C,UAAO,CACjDC,cAAc,CAACC,mBAAf,CAAmC,CAClCC,OAAO,CAAEC,GAAG,CAACC,SAAJ,CAAc,oBAAd,CADyB,CAAnC,EAEGC,IAFH,CAEQ,UAAgB,CACvBR,IAAI,CAACS,KAAL,CAAW,CACVC,YAAY,CAAEV,IAAI,CAACH,SAAL,CAAec,IAAf,CAAoB,aAApB,CADJ,CAEVC,gBAAgB,CAAEZ,IAAI,CAACH,SAAL,CAAec,IAAf,CAAoB,iBAApB,CAFR,CAAX,EAIA,CAPD,EAQA,CATD,EAUA,CArBF,qBAsBC,gBAAmB,iBAAbE,MAAa,wDAAJ,EAAI,CACZC,gBAAgB,CAAGhB,CAAC,CAACiB,qBAAF,EADP,CAElBC,YAAY,CAACC,OAAb,CACCnB,CAAC,CAACoB,MAAF,CACC,CACCC,MAAM,CAAEb,GAAG,CAACc,aAAJ,EADT,CAECC,MAAM,CAAE,KAFT,CADD,CAKCR,MALD,CADD,EAQEL,IARF,CAQO,SAACG,IAAD,CAAU,CAChBG,gBAAgB,CAACQ,iBAAjB,CAAmC,CAAEC,IAAI,CAAE,MAAR,CAAnC,CADgB,CAEhB,IAAIC,MAAM,CAAGb,IAAI,OAAjB,CACgC,WAA5B,SAAOa,MAAM,OAHD,CAIqB,WAAhC,SAAOA,MAAM,WAJF,CAKdlB,GAAG,CAACmB,OAAJ,CAAY,yDAA2DD,MAAM,GAA7E,CALc,CAMiC,WAArC,SAAOA,MAAM,gBANT,CAOdlB,GAAG,CAACmB,OAAJ,CAAYD,MAAM,WAAlB,CAPc,CASdlB,GAAG,CAACoB,iBAAJ,CAAsBF,MAAM,WAA5B,CAA4CA,MAAM,gBAAlD,CATc,EAYf,MAAI,CAAC3B,SAAL,CAAeI,IAAf,CAAoB,oCAApB,EAA0D0B,WAA1D,CAAsE,QAAtE,IAZe,CAaf7B,CAAC,CAAC8B,IAAF,CAAOJ,MAAM,OAAN,UAAP,CAAsC,SAACK,KAAD,CAAQC,KAAR,CAAkB,KACnDC,QAAQ,CAAGD,KAAK,OAAL,SADwC,CAEnDE,OAAO,CAAG,MAAI,CAACnC,SAAL,CAAeI,IAAf,CAAoB,2BAA4B4B,KAA5B,CAAoC,KAAxD,CAFyC,CAGvDG,OAAO,CAAC/B,IAAR,CAAa,sBAAb,EAAqCgC,WAArC,CAAiD,QAAjD,CAHuD,CAIvDD,OAAO,CAAC/B,IAAR,CAAa,sBAAb,EAAqCiC,IAArC,CAA0CH,QAA1C,EACA,CALD,CAbe,CAmBXP,MAAM,OAAN,MAnBW,EAoBdlB,GAAG,CAAC6B,UAAJ,CAAe,CACdD,IAAI,CAAEV,MAAM,OAAN,MADQ,CAEdY,IAAI,CAAE,OAFQ,CAAf,CApBc,EA0BhB,CAlCD,EAmCA,CA3DF,YAAqDC,gBAArD;;"}